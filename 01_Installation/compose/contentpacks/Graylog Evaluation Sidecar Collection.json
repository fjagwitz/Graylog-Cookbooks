{
  "v": 1,
  "id": "6cdfaa77-152c-49d6-880f-a424ab7f24b6",
  "rev": 1,
  "name": "Graylog Evaluation Sidecar Collection",
  "summary": "Graylog Evaluation Sidecar Collection",
  "description": "Graylog Evaluation Sidecar Collection",
  "vendor": "Graylog Evaluation Sidecar Collection",
  "url": "https://github.com/fjagwitz/Graylog-Cookbooks",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "sidecar_collector_configuration",
        "version": "1"
      },
      "id": "0f4c522d-dbd8-47cc-96a9-9a1a11a056a2",
      "data": {
        "collector_id": {
          "@type": "string",
          "@value": "09a5c47a-1738-42f8-9b94-84edc613d952"
        },
        "title": {
          "@type": "string",
          "@value": "self-beats"
        },
        "color": {
          "@type": "string",
          "@value": "#827717"
        },
        "template": {
          "@type": "string",
          "@value": "# Required settings\nfields_under_root: true\nfields.collector_node_id: ${sidecar.nodeName}\nfields.gl2_source_collector: ${sidecar.nodeId}\n\n\noutput.logstash:\n   hosts: [\"${user.graylog_host}:${user.beats_port_self}\"]\npath:\n   data: ${sidecar.spoolDir!\"/var/lib/graylog-sidecar/collectors/filebeat\"}/data\n   logs: ${sidecar.spoolDir!\"/var/lib/graylog-sidecar/collectors/filebeat\"}/log\n\nfilebeat.inputs:\n\n- type: filestream\n  id: syslog-filestream\n  enabled: true\n  paths:\n  - /var/log/syslog\n  fields_under_root: true\n  fields:\n      event_source_product: syslog\n"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.1+29f3984"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "sidecar_collector",
        "version": "1"
      },
      "id": "09a5c47a-1738-42f8-9b94-84edc613d952",
      "data": {
        "name": {
          "@type": "string",
          "@value": "filebeat"
        },
        "service_type": {
          "@type": "string",
          "@value": "exec"
        },
        "node_operating_system": {
          "@type": "string",
          "@value": "linux"
        },
        "executable_path": {
          "@type": "string",
          "@value": "/usr/lib/graylog-sidecar/filebeat"
        },
        "execute_parameters": {
          "@type": "string",
          "@value": "-c  %s"
        },
        "validation_parameters": {
          "@type": "string",
          "@value": "test config -c %s"
        },
        "default_template": {
          "@type": "string",
          "@value": "# Required settings\nfields_under_root: true\nfields.collector_node_id: ${sidecar.nodeName}\nfields.gl2_source_collector: ${sidecar.nodeId}\n\n\noutput.logstash:\n   hosts: [\"${user.graylog_host}:5044\"]\npath:\n   data: ${sidecar.spoolDir!\"/var/lib/graylog-sidecar/collectors/filebeat\"}/data\n   logs: ${sidecar.spoolDir!\"/var/lib/graylog-sidecar/collectors/filebeat\"}/log\n\nfilebeat.inputs:\n\n- type: filestream\n  id: snort-filestream\n  enabled: true\n  paths:\n    - /var/log/snort/alert_json.txt\n    - /var/log/snort/appid-output.json\n  parsers:\n    - ndjson:\n        target: \"snort3\"\n        add_error_key: true\n        overwrite_keys: true\n  fields:\n    event_source_product: snort3\n\n- type: filestream\n  id: zeek-filestream\n  enabled: true\n  paths:\n    - /opt/zeek/logs/current\n  parsers:\n    - ndjson:\n        target: \"zeek\"\n        add_error_key: true\n        overwrite_keys: true\n  fields:\n    event_source_product: zeek\n\n- type: filestream\n  id: apache-filestream\n  enabled: true\n  paths:\n  - /var/log/apache2/access.log\n  - /var/log/apache2/error.log\n  - /var/log/httpd/access_log\n  - /var/log/httpd/error_log\n  fields_under_root: true\n  fields:\n      event_source_product: apache_httpd\n"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.1+29f3984"
        }
      ]
    }
  ]
}