{"id":"32ae2645-f73b-4581-937b-ae6354a063a2","rev":2,"v":"1","name":"Graylog Community Additions: Windows Security","summary":"Graylog Community Additions: Windows Security","description":"","vendor":"Graylog Community Additions: Windows Security","url":"http://test.test.de","created_at":"2026-02-09T10:32:17.648Z","server_version":"7.0.4+ac94792","parameters":[],"entities":[{"id":"e9940af0-ddcc-4d9e-855d-a042dfc16222","type":{"name":"dashboard","version":"2"},"v":"1","data":{"summary":{"@type":"string","@value":"Community Additions: Windows Security"},"search":{"queries":[{"id":"a9efa56f-40d1-488b-82e0-0a1b2bfa1f03","timerange":{"from":300,"type":"relative"},"filters":[],"query":{"type":"elasticsearch","query_string":""},"search_types":[{"query":{"type":"elasticsearch","query_string":"_exists_:gim_tags AND gim_event_type:\"network connection\" AND gim_tags:destination_is_internal AND gim_tags:source_is_internal AND event_action:allowed AND (destination_port:3389 OR network_application:rdp)"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"card(session_id)","field":"session_id"}],"filter":null,"rollup":true,"row_groups":[],"type":"pivot","stream_categories":[],"id":"630074b6-2b15-4418-b975-8e189e16f169","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"gim_tags:remote_access AND gim_event_category:authentication AND gim_event_subcategory:authentication.logoff AND _exists_:session_duration_hours AND windows_elevated_token:No"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"card(user_session_id)","field":"user_session_id"}],"filter":null,"rollup":true,"row_groups":[],"type":"pivot","stream_categories":[],"id":"9fbb7491-6137-4f90-80f3-ba448db85ff5","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"_exists_:gim_tags AND gim_event_type:\"network connection\" AND gim_tags:destination_is_internal AND gim_tags:source_is_internal AND event_action:allowed AND (destination_port:3389 OR network_application:rdp)"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"Number of Sessions","field":"session_id"}],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["source_ip"],"limit":15,"skip_empty_values":false},{"type":"values","fields":["destination_ip"],"limit":15,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"75bb6172-8f6e-4a0a-b3a1-28c4fb6d1416","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"_exists_:gim_tags AND gim_event_type:\"network connection\" AND NOT gim_tags:destination_is_internal AND gim_tags:source_is_internal AND event_action:blocked AND (destination_port:3389 OR network_application:rdp)"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"card(destination_ip)","field":"destination_ip"}],"filter":null,"rollup":true,"row_groups":[],"type":"pivot","stream_categories":[],"id":"b9480b72-ed0c-4bf2-8ecc-f8e529d39fb4","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"_exists_:gim_tags AND gim_event_type:\"network connection\" gim_tags:destination_is_internal AND event_action:allowed AND (destination_port:3389 OR network_application:rdp) AND NOT gim_tags:source_is_internal"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"Connection Source","field":"session_id"}],"filter":null,"rollup":true,"row_groups":[],"type":"pivot","stream_categories":[],"id":"7af95076-5e4e-47e6-8a06-11846965cb74","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"gim_tags:remote_access AND gim_event_subcategory:authentication.logoff AND session_duration_hours:>4"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"Connection Source","field":"user_name"}],"filter":null,"rollup":true,"row_groups":[],"type":"pivot","stream_categories":[],"id":"ef6e8ea6-d0f3-465b-966e-9508c0652aa1","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"_exists_:gim_tags AND gim_event_type:\"network connection\" AND gim_tags:source_is_internal AND event_action:allowed AND (destination_port:3389 OR network_application:rdp) AND NOT gim_tags:destination_is_internal"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"card(session_id)","field":"session_id"}],"filter":null,"rollup":true,"row_groups":[],"type":"pivot","stream_categories":[],"id":"0db6ed02-411f-4526-989a-2269ea7cd14d","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"user_session_id:($active_rdp_sessions$ OR $inactive_rdp_sessions$)"},"name":"chart","timerange":{"from":2592000,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"Different Connections","field":"event_source"}],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["user_name"],"limit":25,"skip_empty_values":true}],"type":"pivot","stream_categories":[],"id":"23754219-2e51-43be-8f34-e0f8e3a0ab67","filters":[],"column_groups":[],"sort":[{"type":"series","field":"card(event_source)","direction":"Descending"}]},{"query":{"type":"elasticsearch","query_string":"gim_tags:remote_access AND gim_event_subcategory:authentication.logoff"},"name":"chart","timerange":{"from":2592000,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"Different Connections","field":"event_source"}],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["user_name"],"limit":25,"skip_empty_values":true}],"type":"pivot","stream_categories":[],"id":"e110ca44-46af-4254-af83-28535f47140e","filters":[],"column_groups":[],"sort":[{"type":"series","field":"card(event_source)","direction":"Descending"}]},{"query":{"type":"elasticsearch","query_string":"gim_tags:remote_access AND gim_event_category:authentication AND gim_event_subcategory:authentication.logoff AND session_duration_hours:4"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"Long Running Sessions","field":"user_session_id"}],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["user_name"],"limit":15,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"b4b58939-dbbc-4f61-8d1e-21c921a2223a","filters":[],"column_groups":[],"sort":[{"type":"series","field":"card(user_session_id)","direction":"Descending"}]}]},{"id":"67b924dc-d190-4163-8a37-b77bda3e7362","timerange":{"from":300,"type":"relative"},"filters":[],"query":{"type":"elasticsearch","query_string":""},"search_types":[{"query":{"type":"elasticsearch","query_string":"user_session_id:$inactive_rdp_sessions$ AND gim_event_type:\"session disconnect\" AND _exists_:(user_session_id AND gim_event_type)"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"card(user_session_id)","field":"user_session_id"}],"filter":null,"rollup":true,"row_groups":[],"type":"pivot","stream_categories":[],"id":"0c30404c-1fee-4763-8a6d-619d936aae63","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"user_session_id:$active_rdp_sessions$ AND _exists_:(user_name AND event_source AND source_ip AND gim_event_type) AND gim_tags:remote_access"},"name":"chart","timerange":{"range":0,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["user_name","event_source","source_ip","source_hostname"],"limit":25,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"f5002bb0-3dc1-4071-99bd-8ad754359440","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name AND event_source) AND windows_elevated_token:No"},"name":"chart","timerange":{"from":2592000,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"sum","id":"Overall Session Duration (mins)","field":"session_duration_minutes"},{"type":"avg","id":"Avg Session Duration (mins)","field":"session_duration_minutes","whole_number":false},{"type":"count","id":"Number of Sessions","field":"user_session_id"}],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["user_name"],"limit":150,"skip_empty_values":false},{"type":"values","fields":["event_source"],"limit":150,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"c32ffcf6-d813-41fa-bfe4-d821686aa70a","filters":[],"column_groups":[],"sort":[{"type":"series","field":"count(user_session_id)","direction":"Descending"}]},{"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name AND event_source) AND windows_elevated_token:No"},"name":"chart","timerange":{"from":2592000,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"sum","id":"Overall Session Duration (mins)","field":"session_duration_minutes"},{"type":"avg","id":"Avg Session Duration (mins)","field":"session_duration_minutes","whole_number":false},{"type":"count","id":"Number of Sessions","field":"user_session_id"}],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["event_source"],"limit":150,"skip_empty_values":false},{"type":"values","fields":["user_name"],"limit":150,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"b92356da-2872-4b80-82dd-44fd84a835f4","filters":[],"column_groups":[],"sort":[{"type":"series","field":"count(user_session_id)","direction":"Descending"}]},{"query":{"type":"elasticsearch","query_string":"user_session_id:$inactive_rdp_sessions$ AND gim_event_type:\"session disconnect\" AND _exists_:(user_name AND event_source AND source_ip AND gim_event_type) "},"name":"chart","timerange":{"range":0,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["user_name","event_source","source_ip","source_hostname"],"limit":25,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"fd260af9-7d07-439b-82f5-b68a1a8a5f03","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"user_session_id:$active_rdp_sessions$"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"card(user_session_id)","field":"user_session_id"}],"filter":null,"rollup":true,"row_groups":[],"type":"pivot","stream_categories":[],"id":"76678ef0-97ac-4496-ac75-a0c9ac542c70","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":""},"name":null,"timerange":{"from":2592000,"type":"relative"},"streams":["000000000000000000000002"],"filter":null,"type":"events","stream_categories":[],"id":"631de59a-4a64-4381-8c83-b170d8939b5d","filters":[]},{"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name) AND windows_elevated_token:No"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"sum","id":"Session Duration","field":"session_duration_minutes"}],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["user_name"],"limit":25,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"37d49a52-eb1a-4c78-8219-044f2e0e9c45","filters":[],"column_groups":[],"sort":[{"type":"series","field":"sum(session_duration_minutes)","direction":"Ascending"}]},{"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name) AND windows_elevated_token:No"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"sum","id":"Session Duration","field":"session_duration_minutes"}],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["user_name"],"limit":25,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"16d4c667-95df-479e-abc0-8ad21f081d73","filters":[],"column_groups":[],"sort":[{"type":"series","field":"sum(session_duration_minutes)","direction":"Descending"}]}]},{"id":"309e5bcb-4b7c-4f6b-8c4d-4f7e8ca26f33","timerange":{"from":300,"type":"relative"},"filters":[],"query":{"type":"elasticsearch","query_string":""},"search_types":[{"query":{"type":"elasticsearch","query_string":"user_session_id:$active_rdp_sessions_elevated$"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"card(user_session_id)","field":"user_session_id"}],"filter":null,"rollup":true,"row_groups":[],"type":"pivot","stream_categories":[],"id":"a8f830ca-da75-4c72-a7f9-b0b3fdfad5db","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name) AND windows_elevated_token:Yes"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"sum","id":"Session Duration","field":"session_duration_minutes"}],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["user_name"],"limit":25,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"a02e16d4-2019-4e28-bd54-7e0b105073d9","filters":[],"column_groups":[],"sort":[{"type":"series","field":"sum(session_duration_minutes)","direction":"Descending"}]},{"query":{"type":"elasticsearch","query_string":"user_session_id:$inactive_rdp_sessions_elevated$ AND gim_event_type:\"session disconnect\" AND _exists_:(user_name AND event_source AND source_ip AND gim_event_type) "},"name":"chart","timerange":{"range":0,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["user_name","event_source","source_ip","source_hostname"],"limit":25,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"d3c5dd18-cf51-473a-bfe7-ef6237c0039d","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"user_session_id:$inactive_rdp_sessions_elevated$ AND gim_event_type:\"session disconnect\" AND _exists_:(user_session_id AND gim_event_type)"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"card","id":"card(user_session_id)","field":"user_session_id"}],"filter":null,"rollup":true,"row_groups":[],"type":"pivot","stream_categories":[],"id":"f6e190d8-287a-47bb-af58-6dd195f0e8f5","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name AND event_source) AND windows_elevated_token:Yes"},"name":"chart","timerange":{"from":2592000,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"sum","id":"Overall Session Duration (mins)","field":"session_duration_minutes"},{"type":"avg","id":"Avg Session Duration (mins)","field":"session_duration_minutes","whole_number":false},{"type":"count","id":"Number of Sessions","field":"user_session_id"}],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["event_source"],"limit":150,"skip_empty_values":false},{"type":"values","fields":["user_name"],"limit":150,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"0b35dad3-9ca6-464a-9d5c-246aa4601303","filters":[],"column_groups":[],"sort":[{"type":"series","field":"count(user_session_id)","direction":"Descending"}]},{"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name AND event_source) AND windows_elevated_token:Yes"},"name":"chart","timerange":{"from":2592000,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"sum","id":"Overall Session Duration (mins)","field":"session_duration_minutes"},{"type":"avg","id":"Avg Session Duration (mins)","field":"session_duration_minutes","whole_number":false},{"type":"count","id":"Number of Sessions","field":"user_session_id"}],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["user_name"],"limit":150,"skip_empty_values":false},{"type":"values","fields":["event_source"],"limit":150,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"f657bec4-434a-4d9b-b8e8-21134a3d5fa3","filters":[],"column_groups":[],"sort":[{"type":"series","field":"count(user_session_id)","direction":"Descending"}]},{"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name) AND windows_elevated_token:Yes"},"name":"chart","timerange":{"from":604800,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[{"type":"sum","id":"Session Duration","field":"session_duration_minutes"}],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["user_name"],"limit":25,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"287975f2-8ccb-47ea-bfa8-a9779155e4a6","filters":[],"column_groups":[],"sort":[{"type":"series","field":"sum(session_duration_minutes)","direction":"Ascending"}]},{"query":{"type":"elasticsearch","query_string":"user_session_id:$active_rdp_sessions_elevated$ AND _exists_:(user_name AND event_source AND source_ip AND gim_event_type) AND gim_tags:remote_access"},"name":"chart","timerange":{"range":0,"type":"relative"},"column_limit":null,"streams":[],"row_limit":null,"series":[],"filter":null,"rollup":true,"row_groups":[{"type":"values","fields":["user_name","event_source","source_ip","source_hostname"],"limit":25,"skip_empty_values":false}],"type":"pivot","stream_categories":[],"id":"08616460-c877-480c-a5c2-978bb3bfdd52","filters":[],"column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"\"Windows - Disconnected RDP Session\" "},"name":null,"timerange":{"from":28800,"type":"relative"},"streams":["000000000000000000000002"],"filter":null,"type":"events","stream_categories":[],"id":"faec35fc-ef28-48e6-9616-e17294c14eea","filters":[]}]}],"parameters":[{"optional":false,"lookup_table":"windows-rdp-monitoring-active-logins","name":"active_rdp_sessions","data_type":"any","default_value":"none","title":"active_rdp_sessions","type":"lut-parameter-v1","description":"active_rdp_sessions","key":"active_rdp_sessions"},{"optional":false,"lookup_table":"windows-rdp-monitoring-active-logins","name":"inactive_rdp_sessions_elevated","data_type":"any","default_value":"none","title":"inactive_rdp_sessions_elevated","type":"lut-parameter-v1","description":"inactive_rdp_sessions_elevated","key":"inactive_rdp_sessions_elevated"},{"optional":false,"lookup_table":"windows-rdp-monitoring-active-logins","name":"active_rdp_sessions_elevated","data_type":"any","default_value":"none","title":"active_rdp_sessions_elevated","type":"lut-parameter-v1","description":"active_rdp_sessions_elevated","key":"active_rdp_sessions_elevated"},{"optional":false,"lookup_table":"windows-rdp-monitoring-active-logins","name":"inactive_rdp_sessions","data_type":"any","default_value":"none","title":"inactive_rdp_sessions","type":"lut-parameter-v1","description":"inactive_rdp_sessions","key":"inactive_rdp_sessions"}],"requires":{"parameters":{"name":"Graylog Enterprise","author":"Graylog, Inc.","url":"https://www.graylog.org/enterprise","version":"3.1.0","description":"Graylog Enterprise","unique_id":"org.graylog.plugins.enterprise.EnterprisePlugin"}},"owner":"eval-admin","created_at":"2026-02-07T17:04:19.198Z"},"created_at":"2024-06-14T17:25:26.453Z","requires":{"parameters":{"name":"Graylog Enterprise","author":"Graylog, Inc.","url":"https://www.graylog.org/enterprise","version":"3.1.0","description":"Graylog Enterprise","unique_id":"org.graylog.plugins.enterprise.EnterprisePlugin"}},"state":{"67b924dc-d190-4163-8a37-b77bda3e7362":{"selected_fields":null,"static_message_list_id":null,"titles":{"tab":{"title":"RDP User Session Insights"},"widget":{"a2691484-fbb3-444a-a39f-f7ab24c84bd9":"Inactive RDP Sessions","05365196-8255-4f47-b011-6f0d75ef3f95":"Inactive RDP Sessions List","de50b0aa-8383-4c6d-8c92-3c23a53c7644":"Messages for user_name:bachte AND event_source:WIN198104.lab.fritzdata.de AND source_ip:172.16.112.102 AND gim_event_type:logon","fe066d7c-3796-4e45-bebf-43ca6b9f3557":"RDP Session Durations Ascending","a4d97060-cc95-4131-b81c-2f072dca2900":"RDP Session Durations Descending","1e7d0e2d-f1a5-4c91-853b-09152a19d88b":"Messages for user_name:bachte AND event_source:WIN198104.lab.fritzdata.de AND source_ip:172.16.112.102 AND gim_event_type:logon","49c73f29-3f79-4f5b-8cdd-c3b9301433a5":"Machines with inactive RDP Connections","2f49c4b1-758f-468f-b943-da6ffab51d84":"Finished RDP Session Durations by User (detailed)","943c52bc-9742-4fae-9535-1fd5989cec35":"Messages for user_name:bachte AND event_source:WIN198104.lab.fritzdata.de","c78ceec3-02b5-4d41-b2c3-4b19654ea1a9":"RDP Events (New)","f8637d4b-34b9-470d-bbbc-ff28fdc03bf3":"Active RDP Sessions","b5d43b02-d732-4afe-80cb-4f24ef05f061":"Finished RDP Session Durations by Machine (detailed)","fd4dd9f6-a69b-4180-a8a5-9739a1b8c844":"Active RDP Sessions List"}},"widgets":[{"config":{"visualization":"bar","units":{},"column_limit":null,"event_annotation":false,"row_limit":25,"row_pivots":[{"fields":["user_name"],"type":"values","config":{"limit":25,"skip_empty_values":false}}],"series":[{"config":{"name":"Session Duration","thresholds":[]},"function":"sum(session_duration_minutes)"}],"rollup":false,"column_pivots":[],"visualization_config":{"barmode":"group","axis_type":"linear"},"formatting_settings":null,"sort":[{"type":"series","field":"sum(session_duration_minutes)","direction":"Descending"}]},"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name) AND windows_elevated_token:No"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"a4d97060-cc95-4131-b81c-2f072dca2900","filters":[],"description":null},{"config":{"visualization":"table","units":{},"column_limit":null,"event_annotation":false,"row_limit":25,"row_pivots":[{"fields":["user_name","event_source","source_ip","source_hostname"],"type":"values","config":{"limit":25}}],"series":[],"rollup":false,"column_pivots":[],"visualization_config":{"pinned_columns":[],"show_row_numbers":true},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"user_session_id:$inactive_rdp_sessions$ AND gim_event_type:\"session disconnect\" AND _exists_:(user_name AND event_source AND source_ip AND gim_event_type) "},"context":null,"timerange":{"range":0,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"05365196-8255-4f47-b011-6f0d75ef3f95","filters":[],"description":null},{"config":{"visualization":"bar","units":{},"column_limit":null,"event_annotation":false,"row_limit":25,"row_pivots":[{"fields":["user_name"],"type":"values","config":{"limit":25,"skip_empty_values":false}}],"series":[{"config":{"name":"Session Duration","thresholds":[]},"function":"sum(session_duration_minutes)"}],"rollup":false,"column_pivots":[],"visualization_config":{"barmode":"group","axis_type":"linear"},"formatting_settings":null,"sort":[{"type":"series","field":"sum(session_duration_minutes)","direction":"Ascending"}]},"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name) AND windows_elevated_token:No"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"fe066d7c-3796-4e45-bebf-43ca6b9f3557","filters":[],"description":null},{"config":{"visualization":"table","units":{},"column_limit":null,"event_annotation":false,"row_limit":150,"row_pivots":[{"fields":["event_source"],"type":"values","config":{"limit":150,"skip_empty_values":false}},{"fields":["user_name"],"type":"values","config":{"limit":150}}],"series":[{"config":{"name":"Overall Session Duration (mins)","thresholds":[]},"function":"sum(session_duration_minutes)"},{"config":{"name":"Avg Session Duration (mins)","thresholds":[]},"function":"avg(session_duration_minutes)"},{"config":{"name":"Number of Sessions","thresholds":[]},"function":"count(user_session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"pinned_columns":[],"show_row_numbers":true},"formatting_settings":null,"sort":[{"type":"series","field":"count(user_session_id)","direction":"Descending"}]},"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name AND event_source) AND windows_elevated_token:No"},"context":null,"timerange":{"from":2592000,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"b5d43b02-d732-4afe-80cb-4f24ef05f061","filters":[],"description":null},{"config":{"visualization":"numeric","units":{},"column_limit":null,"event_annotation":false,"row_limit":null,"row_pivots":[],"series":[{"config":{"name":null,"thresholds":[]},"function":"card(user_session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"trend":false,"trend_preference":"NEUTRAL"},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"user_session_id:$inactive_rdp_sessions$ AND gim_event_type:\"session disconnect\" AND _exists_:(user_session_id AND gim_event_type)"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"a2691484-fbb3-444a-a39f-f7ab24c84bd9","filters":[],"description":null},{"config":{"mode":"List","fields":["alert","event_definition_id","key","status","timestamp"],"units":{},"filters":[{"field":"status","value":["NEW"]},{"field":"event_definition_id","value":["697a5e942300e933d34d9250"]}],"sort":{"field":"timestamp","direction":"Descending"}},"query":{"type":"elasticsearch","query_string":""},"context":null,"timerange":{"from":2592000,"type":"relative"},"streams":["000000000000000000000002"],"filter":null,"type":"events","stream_categories":[],"id":"c78ceec3-02b5-4d41-b2c3-4b19654ea1a9","filters":[],"description":null},{"config":{"visualization":"numeric","units":{},"column_limit":null,"event_annotation":false,"row_limit":null,"row_pivots":[],"series":[{"config":{"name":null,"thresholds":[]},"function":"card(user_session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"trend":false,"trend_preference":"NEUTRAL"},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"user_session_id:$active_rdp_sessions$"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"f8637d4b-34b9-470d-bbbc-ff28fdc03bf3","filters":[],"description":null},{"config":{"visualization":"table","units":{},"column_limit":null,"event_annotation":false,"row_limit":25,"row_pivots":[{"fields":["user_name","event_source","source_ip","source_hostname"],"type":"values","config":{"limit":25}}],"series":[],"rollup":false,"column_pivots":[],"visualization_config":{"pinned_columns":[],"show_row_numbers":true},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"user_session_id:$active_rdp_sessions$ AND _exists_:(user_name AND event_source AND source_ip AND gim_event_type) AND gim_tags:remote_access"},"context":null,"timerange":{"range":0,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"fd4dd9f6-a69b-4180-a8a5-9739a1b8c844","filters":[],"description":null},{"config":{"visualization":"table","units":{},"column_limit":null,"event_annotation":false,"row_limit":150,"row_pivots":[{"fields":["user_name"],"type":"values","config":{"limit":150,"skip_empty_values":false}},{"fields":["event_source"],"type":"values","config":{"limit":150}}],"series":[{"config":{"name":"Overall Session Duration (mins)","thresholds":[]},"function":"sum(session_duration_minutes)"},{"config":{"name":"Avg Session Duration (mins)","thresholds":[]},"function":"avg(session_duration_minutes)"},{"config":{"name":"Number of Sessions","thresholds":[]},"function":"count(user_session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"pinned_columns":[],"show_row_numbers":true},"formatting_settings":null,"sort":[{"type":"series","field":"count(user_session_id)","direction":"Descending"}]},"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name AND event_source) AND windows_elevated_token:No"},"context":null,"timerange":{"from":2592000,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"2f49c4b1-758f-468f-b943-da6ffab51d84","filters":[],"description":null}],"widget_mapping":{"a2691484-fbb3-444a-a39f-f7ab24c84bd9":["0c30404c-1fee-4763-8a6d-619d936aae63"],"05365196-8255-4f47-b011-6f0d75ef3f95":["fd260af9-7d07-439b-82f5-b68a1a8a5f03"],"fe066d7c-3796-4e45-bebf-43ca6b9f3557":["37d49a52-eb1a-4c78-8219-044f2e0e9c45"],"a4d97060-cc95-4131-b81c-2f072dca2900":["16d4c667-95df-479e-abc0-8ad21f081d73"],"2f49c4b1-758f-468f-b943-da6ffab51d84":["c32ffcf6-d813-41fa-bfe4-d821686aa70a"],"c78ceec3-02b5-4d41-b2c3-4b19654ea1a9":["631de59a-4a64-4381-8c83-b170d8939b5d"],"f8637d4b-34b9-470d-bbbc-ff28fdc03bf3":["76678ef0-97ac-4496-ac75-a0c9ac542c70"],"b5d43b02-d732-4afe-80cb-4f24ef05f061":["b92356da-2872-4b80-82dd-44fd84a835f4"],"fd4dd9f6-a69b-4180-a8a5-9739a1b8c844":["f5002bb0-3dc1-4071-99bd-8ad754359440"]},"positions":{"a2691484-fbb3-444a-a39f-f7ab24c84bd9":{"col":1,"row":4,"height":3,"width":3},"05365196-8255-4f47-b011-6f0d75ef3f95":{"col":4,"row":4,"height":3,"width":5},"fe066d7c-3796-4e45-bebf-43ca6b9f3557":{"col":7,"row":7,"height":4,"width":6},"a4d97060-cc95-4131-b81c-2f072dca2900":{"col":1,"row":7,"height":4,"width":6},"2f49c4b1-758f-468f-b943-da6ffab51d84":{"col":1,"row":11,"height":4,"width":"Infinity"},"c78ceec3-02b5-4d41-b2c3-4b19654ea1a9":{"col":9,"row":1,"height":6,"width":4},"f8637d4b-34b9-470d-bbbc-ff28fdc03bf3":{"col":1,"row":1,"height":3,"width":3},"b5d43b02-d732-4afe-80cb-4f24ef05f061":{"col":1,"row":15,"height":4,"width":"Infinity"},"fd4dd9f6-a69b-4180-a8a5-9739a1b8c844":{"col":4,"row":1,"height":3,"width":5}},"formatting":{"highlighting":[]},"display_mode_settings":{"positions":{}}},"309e5bcb-4b7c-4f6b-8c4d-4f7e8ca26f33":{"selected_fields":null,"static_message_list_id":null,"titles":{"tab":{"title":"RDP Admin Session Insights"},"widget":{"b7a5d12b-3fda-4902-87e8-6cd3e07399c9":"Messages for user_name:administrator AND event_source:WIN198101.demo.io AND source_ip:fe80\\:\\:64fb\\:2465\\:7b10\\:1f77","595c9b54-ef5c-4557-8ce2-3800e4eeaeb8":"Active RDP Sessions","a28366e5-f49d-4a47-a42c-fc1c0aa627eb":"RDP Session Durations Ascending","4001a67e-fe0f-4cc4-ae42-88dc035f98b1":"Finished RDP Session Durations by Machine (detailed)","d4a93ce1-bf88-45d8-839e-72ea2602a26f":"Inactive RDP Sessions","undefined":"Messages for user_name:bachte AND event_source:WIN198104.lab.fritzdata.de","fb4b68fe-c910-4ea6-b8ba-4e53cbf3511c":"Inactive RDP Sessions List","28100805-7712-4c4c-9e9a-4cd10092f86e":"Messages for user_name:\"james jackson\"","6b0dbff3-ab92-4b37-a76d-75520a3c2c35":"RDP Session Durations Descending","0867bc16-f82e-42b0-8bc0-4c2de705e3c2":"Active RDP Sessions List","4b01eede-5f74-4719-ad5d-b554830ff2f2":"Finished RDP Session Durations by User (detailed)","b41bbc00-8d01-44ce-a733-c9fcbe4fd297":"Messages for user_name:\"james martinez\" AND event_source:WIN198104.demo.io","efb32f7c-5fa1-4690-bdff-cf88ac16825e":"RDP Events (New)","82a9a932-9cc4-433d-8f4b-3439be4af51f":"RDP Events (New)"}},"widgets":[{"config":{"visualization":"table","units":{},"column_limit":null,"event_annotation":false,"row_limit":150,"row_pivots":[{"fields":["user_name"],"type":"values","config":{"limit":150,"skip_empty_values":false}},{"fields":["event_source"],"type":"values","config":{"limit":150}}],"series":[{"config":{"name":"Overall Session Duration (mins)","thresholds":[]},"function":"sum(session_duration_minutes)"},{"config":{"name":"Avg Session Duration (mins)","thresholds":[]},"function":"avg(session_duration_minutes)"},{"config":{"name":"Number of Sessions","thresholds":[]},"function":"count(user_session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"pinned_columns":[],"show_row_numbers":true},"formatting_settings":null,"sort":[{"type":"series","field":"count(user_session_id)","direction":"Descending"}]},"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name AND event_source) AND windows_elevated_token:Yes"},"context":null,"timerange":{"from":2592000,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"4b01eede-5f74-4719-ad5d-b554830ff2f2","filters":[],"description":null},{"config":{"visualization":"table","units":{},"column_limit":null,"event_annotation":false,"row_limit":150,"row_pivots":[{"fields":["event_source"],"type":"values","config":{"limit":150,"skip_empty_values":false}},{"fields":["user_name"],"type":"values","config":{"limit":150}}],"series":[{"config":{"name":"Overall Session Duration (mins)","thresholds":[]},"function":"sum(session_duration_minutes)"},{"config":{"name":"Avg Session Duration (mins)","thresholds":[]},"function":"avg(session_duration_minutes)"},{"config":{"name":"Number of Sessions","thresholds":[]},"function":"count(user_session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"pinned_columns":[],"show_row_numbers":true},"formatting_settings":null,"sort":[{"type":"series","field":"count(user_session_id)","direction":"Descending"}]},"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name AND event_source) AND windows_elevated_token:Yes"},"context":null,"timerange":{"from":2592000,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"4001a67e-fe0f-4cc4-ae42-88dc035f98b1","filters":[],"description":null},{"config":{"visualization":"numeric","units":{},"column_limit":null,"event_annotation":false,"row_limit":null,"row_pivots":[],"series":[{"config":{"name":null,"thresholds":[]},"function":"card(user_session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"trend":false,"trend_preference":"NEUTRAL"},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"user_session_id:$inactive_rdp_sessions_elevated$ AND gim_event_type:\"session disconnect\" AND _exists_:(user_session_id AND gim_event_type)"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"d4a93ce1-bf88-45d8-839e-72ea2602a26f","filters":[],"description":null},{"config":{"visualization":"bar","units":{},"column_limit":null,"event_annotation":false,"row_limit":25,"row_pivots":[{"fields":["user_name"],"type":"values","config":{"limit":25,"skip_empty_values":false}}],"series":[{"config":{"name":"Session Duration","thresholds":[]},"function":"sum(session_duration_minutes)"}],"rollup":false,"column_pivots":[],"visualization_config":{"barmode":"group","axis_type":"linear"},"formatting_settings":null,"sort":[{"type":"series","field":"sum(session_duration_minutes)","direction":"Ascending"}]},"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name) AND windows_elevated_token:Yes"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"a28366e5-f49d-4a47-a42c-fc1c0aa627eb","filters":[],"description":null},{"config":{"visualization":"numeric","units":{},"column_limit":null,"event_annotation":false,"row_limit":null,"row_pivots":[],"series":[{"config":{"name":null,"thresholds":[]},"function":"card(user_session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"trend":false,"trend_preference":"NEUTRAL"},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"user_session_id:$active_rdp_sessions_elevated$"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"595c9b54-ef5c-4557-8ce2-3800e4eeaeb8","filters":[],"description":null},{"config":{"visualization":"table","units":{},"column_limit":null,"event_annotation":false,"row_limit":25,"row_pivots":[{"fields":["user_name","event_source","source_ip","source_hostname"],"type":"values","config":{"limit":25}}],"series":[],"rollup":false,"column_pivots":[],"visualization_config":{"pinned_columns":[],"show_row_numbers":true},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"user_session_id:$active_rdp_sessions_elevated$ AND _exists_:(user_name AND event_source AND source_ip AND gim_event_type) AND gim_tags:remote_access"},"context":null,"timerange":{"range":0,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"0867bc16-f82e-42b0-8bc0-4c2de705e3c2","filters":[],"description":null},{"config":{"mode":"List","fields":["alert","event_definition_id","key","status","timestamp"],"units":{},"filters":[{"field":"status","value":["NEW"]}],"sort":{"field":"timestamp","direction":"Descending"}},"query":{"type":"elasticsearch","query_string":"\"Windows - Disconnected RDP Session\" "},"context":null,"timerange":{"from":28800,"type":"relative"},"streams":["000000000000000000000002"],"filter":null,"type":"events","stream_categories":[],"id":"82a9a932-9cc4-433d-8f4b-3439be4af51f","filters":[],"description":null},{"config":{"visualization":"bar","units":{},"column_limit":null,"event_annotation":false,"row_limit":25,"row_pivots":[{"fields":["user_name"],"type":"values","config":{"limit":25,"skip_empty_values":false}}],"series":[{"config":{"name":"Session Duration","thresholds":[]},"function":"sum(session_duration_minutes)"}],"rollup":false,"column_pivots":[],"visualization_config":{"barmode":"group","axis_type":"linear"},"formatting_settings":null,"sort":[{"type":"series","field":"sum(session_duration_minutes)","direction":"Descending"}]},"query":{"type":"elasticsearch","query_string":"_exists_:(session_duration_minutes AND user_name) AND windows_elevated_token:Yes"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"6b0dbff3-ab92-4b37-a76d-75520a3c2c35","filters":[],"description":null},{"config":{"visualization":"table","units":{},"column_limit":null,"event_annotation":false,"row_limit":25,"row_pivots":[{"fields":["user_name","event_source","source_ip","source_hostname"],"type":"values","config":{"limit":25}}],"series":[],"rollup":false,"column_pivots":[],"visualization_config":{"pinned_columns":[],"show_row_numbers":true},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"user_session_id:$inactive_rdp_sessions_elevated$ AND gim_event_type:\"session disconnect\" AND _exists_:(user_name AND event_source AND source_ip AND gim_event_type) "},"context":null,"timerange":{"range":0,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"fb4b68fe-c910-4ea6-b8ba-4e53cbf3511c","filters":[],"description":null}],"widget_mapping":{"595c9b54-ef5c-4557-8ce2-3800e4eeaeb8":["a8f830ca-da75-4c72-a7f9-b0b3fdfad5db"],"a28366e5-f49d-4a47-a42c-fc1c0aa627eb":["287975f2-8ccb-47ea-bfa8-a9779155e4a6"],"4001a67e-fe0f-4cc4-ae42-88dc035f98b1":["0b35dad3-9ca6-464a-9d5c-246aa4601303"],"d4a93ce1-bf88-45d8-839e-72ea2602a26f":["f6e190d8-287a-47bb-af58-6dd195f0e8f5"],"fb4b68fe-c910-4ea6-b8ba-4e53cbf3511c":["d3c5dd18-cf51-473a-bfe7-ef6237c0039d"],"6b0dbff3-ab92-4b37-a76d-75520a3c2c35":["a02e16d4-2019-4e28-bd54-7e0b105073d9"],"0867bc16-f82e-42b0-8bc0-4c2de705e3c2":["08616460-c877-480c-a5c2-978bb3bfdd52"],"4b01eede-5f74-4719-ad5d-b554830ff2f2":["f657bec4-434a-4d9b-b8e8-21134a3d5fa3"],"82a9a932-9cc4-433d-8f4b-3439be4af51f":["faec35fc-ef28-48e6-9616-e17294c14eea"]},"positions":{"595c9b54-ef5c-4557-8ce2-3800e4eeaeb8":{"col":1,"row":1,"height":3,"width":3},"a28366e5-f49d-4a47-a42c-fc1c0aa627eb":{"col":7,"row":7,"height":4,"width":6},"4001a67e-fe0f-4cc4-ae42-88dc035f98b1":{"col":1,"row":15,"height":4,"width":"Infinity"},"d4a93ce1-bf88-45d8-839e-72ea2602a26f":{"col":1,"row":4,"height":3,"width":3},"fb4b68fe-c910-4ea6-b8ba-4e53cbf3511c":{"col":4,"row":4,"height":3,"width":5},"6b0dbff3-ab92-4b37-a76d-75520a3c2c35":{"col":1,"row":7,"height":4,"width":6},"0867bc16-f82e-42b0-8bc0-4c2de705e3c2":{"col":4,"row":1,"height":3,"width":5},"4b01eede-5f74-4719-ad5d-b554830ff2f2":{"col":1,"row":11,"height":4,"width":"Infinity"},"82a9a932-9cc4-433d-8f4b-3439be4af51f":{"col":9,"row":1,"height":6,"width":4}},"formatting":{"highlighting":[]},"display_mode_settings":{"positions":{}}},"a9efa56f-40d1-488b-82e0-0a1b2bfa1f03":{"selected_fields":null,"static_message_list_id":null,"titles":{"tab":{"title":"Risk Indicators based on RDP"},"widget":{"7d2d075c-2f04-47e8-99c0-c79de07d93f0":"Active Admin Sessions (copy)","5c1121b2-8430-4ff0-8614-4affb7550791":"Inactive Admin Sessions","bc5ac17c-2a4d-4aaf-aa6e-a4df87a2d247":"Inactive User Sessions","dda5f2c9-f66e-4175-acae-514d874e6870":"Total Admin Sessions (currently)","abd7426e-b772-42c6-a2c0-bfc8ba7e6af4":"Outbound Sessions (last 7 days)","f9f61b72-30c7-4e6f-86e8-6fe11e4a29c8":"Active User Sessions","d4cdae48-bf0a-4f6b-a9b1-0749264db0ce":"Total User Sessions (last 7 days)","be9d41e7-ba5e-43bc-831a-153580703e45":"Active Admin Sessions","831a9582-46bf-4eb8-a26f-62f49b700033":"Long Running Sessions (last 7 days)","08d4afa6-1b28-46fd-a0f5-33491ccb3ce2":"Sessions per Host (last 7 days)","9c5c7766-5891-4ced-81e4-b24259d8505b":"Messages for user_name:\"james martinez\"","a70f0b91-1499-4deb-a3e1-c0bf4efc4dbc":"Sessions per Machine","670795db-b8ec-4215-993c-1f5f6335dc6f":"Sessions by User (Current)","74c1719c-75b7-4306-a4ec-e68f290e4b51":"Messages for user_name:\"james martinez\"","a5f8c945-b155-44e5-98a9-94dfa6a3a184":"Sessions by User (last 7 days)","af1248ea-05d5-4dac-ab71-b7adb9b70e91":"Inbound Sessions (last 7 days)","05faf727-d9b1-45d7-9308-e5c16ffc748f":"Internal Sessions (last 7 days)","bc55e6d2-1345-457e-b128-9455c81dbf30":"Long Running Session Users","456d96b4-f553-4dd4-8522-1ec737e7fee1":"Failed Outbound Connection Attempts"}},"widgets":[{"config":{"visualization":"numeric","units":{},"column_limit":null,"event_annotation":false,"row_limit":null,"row_pivots":[],"series":[{"config":{"name":null,"thresholds":[]},"function":"card(destination_ip)"}],"rollup":false,"column_pivots":[],"visualization_config":{"trend":false,"trend_preference":"NEUTRAL"},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"_exists_:gim_tags AND gim_event_type:\"network connection\" AND NOT gim_tags:destination_is_internal AND gim_tags:source_is_internal AND event_action:blocked AND (destination_port:3389 OR network_application:rdp)"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"456d96b4-f553-4dd4-8522-1ec737e7fee1","filters":[],"description":null},{"config":{"visualization":"numeric","units":{},"column_limit":null,"event_annotation":false,"row_limit":null,"row_pivots":[],"series":[{"config":{"name":"Connection Source","thresholds":[]},"function":"card(user_name)"}],"rollup":false,"column_pivots":[],"visualization_config":{"trend":false,"trend_preference":"NEUTRAL"},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"gim_tags:remote_access AND gim_event_subcategory:authentication.logoff AND session_duration_hours:>4"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"831a9582-46bf-4eb8-a26f-62f49b700033","filters":[],"description":null},{"config":{"visualization":"numeric","units":{},"column_limit":null,"event_annotation":false,"row_limit":null,"row_pivots":[],"series":[{"config":{"name":null,"thresholds":[]},"function":"card(session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"trend":false,"trend_preference":"NEUTRAL"},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"_exists_:gim_tags AND gim_event_type:\"network connection\" AND gim_tags:source_is_internal AND event_action:allowed AND (destination_port:3389 OR network_application:rdp) AND NOT gim_tags:destination_is_internal"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"abd7426e-b772-42c6-a2c0-bfc8ba7e6af4","filters":[],"description":null},{"config":{"visualization":"numeric","units":{},"column_limit":null,"event_annotation":false,"row_limit":null,"row_pivots":[],"series":[{"config":{"name":"Connection Source","thresholds":[]},"function":"card(session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"trend":false,"trend_preference":"NEUTRAL"},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"_exists_:gim_tags AND gim_event_type:\"network connection\" gim_tags:destination_is_internal AND event_action:allowed AND (destination_port:3389 OR network_application:rdp) AND NOT gim_tags:source_is_internal"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"af1248ea-05d5-4dac-ab71-b7adb9b70e91","filters":[],"description":null},{"config":{"visualization":"bar","units":{},"column_limit":null,"event_annotation":false,"row_limit":25,"row_pivots":[{"fields":["user_name"],"type":"values","config":{"limit":25,"skip_empty_values":true}}],"series":[{"config":{"name":"Different Connections","thresholds":[{"color":"#bab36d","name":"Baseline for normal behaviour","value":1}]},"function":"card(event_source)"}],"rollup":false,"column_pivots":[],"visualization_config":{"barmode":"group","axis_type":"linear"},"formatting_settings":null,"sort":[{"type":"series","field":"card(event_source)","direction":"Descending"}]},"query":{"type":"elasticsearch","query_string":"gim_tags:remote_access AND gim_event_subcategory:authentication.logoff"},"context":null,"timerange":{"from":2592000,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"a5f8c945-b155-44e5-98a9-94dfa6a3a184","filters":[],"description":null},{"config":{"visualization":"bar","units":{},"column_limit":null,"event_annotation":false,"row_limit":25,"row_pivots":[{"fields":["user_name"],"type":"values","config":{"limit":25,"skip_empty_values":true}}],"series":[{"config":{"name":"Different Connections","thresholds":[{"color":"#bab36d","name":"Baseline for normal behaviour","value":1}]},"function":"card(event_source)"}],"rollup":false,"column_pivots":[],"visualization_config":{"barmode":"group","axis_type":"linear"},"formatting_settings":null,"sort":[{"type":"series","field":"card(event_source)","direction":"Descending"}]},"query":{"type":"elasticsearch","query_string":"user_session_id:($active_rdp_sessions$ OR $inactive_rdp_sessions$)"},"context":null,"timerange":{"from":2592000,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"670795db-b8ec-4215-993c-1f5f6335dc6f","filters":[],"description":null},{"config":{"visualization":"bar","units":{},"column_limit":null,"event_annotation":false,"row_limit":15,"row_pivots":[{"fields":["user_name"],"type":"values","config":{"limit":15}}],"series":[{"config":{"name":"Long Running Sessions","thresholds":[]},"function":"card(user_session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"barmode":"group","axis_type":"linear"},"formatting_settings":null,"sort":[{"type":"series","field":"card(user_session_id)","direction":"Descending"}]},"query":{"type":"elasticsearch","query_string":"gim_tags:remote_access AND gim_event_category:authentication AND gim_event_subcategory:authentication.logoff AND session_duration_hours:4"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"bc55e6d2-1345-457e-b128-9455c81dbf30","filters":[],"description":null},{"config":{"visualization":"table","units":{},"column_limit":null,"event_annotation":false,"row_limit":15,"row_pivots":[{"fields":["source_ip"],"type":"values","config":{"limit":15,"skip_empty_values":false}},{"fields":["destination_ip"],"type":"values","config":{"limit":15}}],"series":[{"config":{"name":"Number of Sessions","thresholds":[]},"function":"card(session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"pinned_columns":[],"show_row_numbers":true},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"_exists_:gim_tags AND gim_event_type:\"network connection\" AND gim_tags:destination_is_internal AND gim_tags:source_is_internal AND event_action:allowed AND (destination_port:3389 OR network_application:rdp)"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"08d4afa6-1b28-46fd-a0f5-33491ccb3ce2","filters":[],"description":null},{"config":{"visualization":"numeric","units":{},"column_limit":null,"event_annotation":false,"row_limit":null,"row_pivots":[],"series":[{"config":{"name":null,"thresholds":[]},"function":"card(user_session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"trend":false,"trend_preference":"NEUTRAL"},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"gim_tags:remote_access AND gim_event_category:authentication AND gim_event_subcategory:authentication.logoff AND _exists_:session_duration_hours AND windows_elevated_token:No"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"d4cdae48-bf0a-4f6b-a9b1-0749264db0ce","filters":[],"description":null},{"config":{"visualization":"numeric","units":{},"column_limit":null,"event_annotation":false,"row_limit":null,"row_pivots":[],"series":[{"config":{"name":null,"thresholds":[]},"function":"card(session_id)"}],"rollup":false,"column_pivots":[],"visualization_config":{"trend":false,"trend_preference":"NEUTRAL"},"formatting_settings":null,"sort":[]},"query":{"type":"elasticsearch","query_string":"_exists_:gim_tags AND gim_event_type:\"network connection\" AND gim_tags:destination_is_internal AND gim_tags:source_is_internal AND event_action:allowed AND (destination_port:3389 OR network_application:rdp)"},"context":null,"timerange":{"from":604800,"type":"relative"},"streams":[],"filter":null,"type":"aggregation","stream_categories":[],"id":"05faf727-d9b1-45d7-9308-e5c16ffc748f","filters":[],"description":null}],"widget_mapping":{"abd7426e-b772-42c6-a2c0-bfc8ba7e6af4":["0db6ed02-411f-4526-989a-2269ea7cd14d"],"d4cdae48-bf0a-4f6b-a9b1-0749264db0ce":["9fbb7491-6137-4f90-80f3-ba448db85ff5"],"831a9582-46bf-4eb8-a26f-62f49b700033":["ef6e8ea6-d0f3-465b-966e-9508c0652aa1"],"08d4afa6-1b28-46fd-a0f5-33491ccb3ce2":["75bb6172-8f6e-4a0a-b3a1-28c4fb6d1416"],"670795db-b8ec-4215-993c-1f5f6335dc6f":["23754219-2e51-43be-8f34-e0f8e3a0ab67"],"a5f8c945-b155-44e5-98a9-94dfa6a3a184":["e110ca44-46af-4254-af83-28535f47140e"],"af1248ea-05d5-4dac-ab71-b7adb9b70e91":["7af95076-5e4e-47e6-8a06-11846965cb74"],"05faf727-d9b1-45d7-9308-e5c16ffc748f":["630074b6-2b15-4418-b975-8e189e16f169"],"bc55e6d2-1345-457e-b128-9455c81dbf30":["b4b58939-dbbc-4f61-8d1e-21c921a2223a"],"456d96b4-f553-4dd4-8522-1ec737e7fee1":["b9480b72-ed0c-4bf2-8ecc-f8e529d39fb4"]},"positions":{"abd7426e-b772-42c6-a2c0-bfc8ba7e6af4":{"col":3,"row":3,"height":2,"width":2},"d4cdae48-bf0a-4f6b-a9b1-0749264db0ce":{"col":1,"row":1,"height":2,"width":2},"831a9582-46bf-4eb8-a26f-62f49b700033":{"col":3,"row":1,"height":2,"width":2},"08d4afa6-1b28-46fd-a0f5-33491ccb3ce2":{"col":1,"row":7,"height":3,"width":4},"670795db-b8ec-4215-993c-1f5f6335dc6f":{"col":5,"row":1,"height":3,"width":8},"a5f8c945-b155-44e5-98a9-94dfa6a3a184":{"col":5,"row":4,"height":3,"width":8},"af1248ea-05d5-4dac-ab71-b7adb9b70e91":{"col":1,"row":3,"height":2,"width":2},"05faf727-d9b1-45d7-9308-e5c16ffc748f":{"col":1,"row":5,"height":2,"width":2},"bc55e6d2-1345-457e-b128-9455c81dbf30":{"col":5,"row":7,"height":3,"width":8},"456d96b4-f553-4dd4-8522-1ec737e7fee1":{"col":3,"row":5,"height":2,"width":2}},"formatting":{"highlighting":[]},"display_mode_settings":{"positions":{}}}},"properties":[],"owner":"Graylog Professionals","title":{"@type":"string","@value":"Community Additions: Windows Security"},"type":"DASHBOARD","description":{"@type":"string","@value":"Community Additions: Windows Security"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"080d0e3b-22df-43a6-bd36-795654e4c7ec","type":{"name":"lookup_adapter","version":"1"},"v":"1","data":{"_scope":{"@type":"string","@value":"DEFAULT"},"name":{"@type":"string","@value":"windows-rdp-monitoring-login-timestamps"},"title":{"@type":"string","@value":"windows-rdp-monitoring-login-timestamps"},"description":{"@type":"string","@value":"windows-rdp-monitoring-login-timestamps"},"configuration":{"type":{"@type":"string","@value":"mongodb"},"cidr_lookup":{"@type":"boolean","@value":false}}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"5f92cfaa-5d4d-494d-ab3d-2874b6d543ff","type":{"name":"lookup_adapter","version":"1"},"v":"1","data":{"_scope":{"@type":"string","@value":"DEFAULT"},"name":{"@type":"string","@value":"windows-rdp-monitoring-source-hostnames"},"title":{"@type":"string","@value":"windows-rdp-monitoring-source-hostnames"},"description":{"@type":"string","@value":"windows-rdp-monitoring-source-hostnames"},"configuration":{"type":{"@type":"string","@value":"dnslookup"},"lookup_type":{"@type":"string","@value":"PTR"},"server_ips":{"@type":"string","@value":"172.16.198.101,172.16.198.102"},"request_timeout":{"@type":"integer","@value":10000},"cache_ttl_override_enabled":{"@type":"boolean","@value":false}}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"cd1b695a-cce4-47de-b2d6-9bf19e399d52","type":{"name":"lookup_adapter","version":"1"},"v":"1","data":{"_scope":{"@type":"string","@value":"DEFAULT"},"name":{"@type":"string","@value":"windows-rdp-monitoring-active-logins"},"title":{"@type":"string","@value":"windows-rdp-monitoring-active-logins"},"description":{"@type":"string","@value":"windows-rdp-monitoring-active-logins"},"configuration":{"type":{"@type":"string","@value":"mongodb"},"cidr_lookup":{"@type":"boolean","@value":false}}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"d67d3d4d-679a-4167-981b-7daaa8c1d2c1","type":{"name":"lookup_cache","version":"1"},"v":"1","data":{"_scope":{"@type":"string","@value":"DEFAULT"},"name":{"@type":"string","@value":"windows-rdp-monitoring-active-logins"},"title":{"@type":"string","@value":"windows-rdp-monitoring-active-logins"},"description":{"@type":"string","@value":"windows-rdp-monitoring-active-logins"},"configuration":{"type":{"@type":"string","@value":"none"}}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"0d432aea-c3a5-4f40-b1ae-e375efdeea03","type":{"name":"lookup_cache","version":"1"},"v":"1","data":{"_scope":{"@type":"string","@value":"DEFAULT"},"name":{"@type":"string","@value":"windows-rdp-monitoring-login-timestamps"},"title":{"@type":"string","@value":"windows-rdp-monitoring-login-timestamps"},"description":{"@type":"string","@value":"windows-rdp-monitoring-login-timestamps"},"configuration":{"type":{"@type":"string","@value":"none"}}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"3d36360d-2ca3-44a6-b4eb-40d04c4f3181","type":{"name":"lookup_cache","version":"1"},"v":"1","data":{"_scope":{"@type":"string","@value":"DEFAULT"},"name":{"@type":"string","@value":"windows-rdp-monitoring-source-hostnames"},"title":{"@type":"string","@value":"windows-rdp-monitoring-source-hostnames"},"description":{"@type":"string","@value":"windows-rdp-monitoring-source-hostnames"},"configuration":{"type":{"@type":"string","@value":"none"}}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"ed1be30c-87d1-46d6-a8ca-62ffa3b33873","type":{"name":"lookup_table","version":"1"},"v":"1","data":{"default_single_value_type":{"@type":"string","@value":"NULL"},"cache_name":{"@type":"string","@value":"3d36360d-2ca3-44a6-b4eb-40d04c4f3181"},"name":{"@type":"string","@value":"windows-rdp-monitoring-source-hostnames"},"default_multi_value_type":{"@type":"string","@value":"NULL"},"default_multi_value":{"@type":"string","@value":""},"data_adapter_name":{"@type":"string","@value":"5f92cfaa-5d4d-494d-ab3d-2874b6d543ff"},"_scope":{"@type":"string","@value":"DEFAULT"},"title":{"@type":"string","@value":"windows-rdp-monitoring-source-hostnames"},"default_single_value":{"@type":"string","@value":"\"Reverse DNS resolution for this IP not available\" "},"description":{"@type":"string","@value":"windows-rdp-monitoring-source-hostnames"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"998e71eb-fe0f-4362-b2ad-7cfa7b86f3a2","type":{"name":"lookup_table","version":"1"},"v":"1","data":{"default_single_value_type":{"@type":"string","@value":"NULL"},"cache_name":{"@type":"string","@value":"d67d3d4d-679a-4167-981b-7daaa8c1d2c1"},"name":{"@type":"string","@value":"windows-rdp-monitoring-active-logins"},"default_multi_value_type":{"@type":"string","@value":"NULL"},"default_multi_value":{"@type":"string","@value":""},"data_adapter_name":{"@type":"string","@value":"cd1b695a-cce4-47de-b2d6-9bf19e399d52"},"_scope":{"@type":"string","@value":"DEFAULT"},"title":{"@type":"string","@value":"windows-rdp-monitoring-active-logins"},"default_single_value":{"@type":"string","@value":""},"description":{"@type":"string","@value":"windows-rdp-monitoring-active-logins"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"fdef056c-d896-41a7-9e63-02177d2a7b90","type":{"name":"lookup_table","version":"1"},"v":"1","data":{"default_single_value_type":{"@type":"string","@value":"NULL"},"cache_name":{"@type":"string","@value":"0d432aea-c3a5-4f40-b1ae-e375efdeea03"},"name":{"@type":"string","@value":"windows-rdp-monitoring-login-timestamps"},"default_multi_value_type":{"@type":"string","@value":"NULL"},"default_multi_value":{"@type":"string","@value":""},"data_adapter_name":{"@type":"string","@value":"080d0e3b-22df-43a6-bd36-795654e4c7ec"},"_scope":{"@type":"string","@value":"DEFAULT"},"title":{"@type":"string","@value":"windows-rdp-monitoring-login-timestamps"},"default_single_value":{"@type":"string","@value":""},"description":{"@type":"string","@value":"windows-rdp-monitoring-login-timestamps"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"60488aa2-c2e0-40b6-a653-27f0cba1ce3c","type":{"name":"pipeline","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security"},"description":{"@type":"string","@value":"Additions - Windows Security"},"source":{"@type":"string","@value":"pipeline \"Additions - Windows Security\"\nstage 1 match all\nrule \"Additions - Windows Security - 001\"\nstage 40 match pass\nrule \"Additions - Windows Security - 040 - N\"\nrule \"Additions - Windows Security - 040 - W\"\nstage 42 match pass\nrule \"Additions - Windows Security - 042 - N\"\nrule \"Additions - Windows Security - 042 - W\"\nstage 44 match pass\nrule \"Additions - Windows Security - 044 - N\"\nrule \"Additions - Windows Security - 044 - W\"\nstage 61 match pass\nrule \"Additions - Windows Security - 061\"\nstage 62 match pass\nrule \"Additions - Windows Security - 062\"\nstage 64 match pass\nrule \"Additions - Windows Security - 064\"\nrule \"Additions - Windows Security - 065\"\nstage 110 match pass\nrule \"Additions - Windows Security - 111\"\nrule \"Additions - Windows Security - 112\"\nstage 120 match pass\nrule \"Additions - Windows Security - 121\"\nrule \"Additions - Windows Security - 122\"\nstage 130 match pass\nrule \"Additions - Windows Security - 131\"\nrule \"Additions - Windows Security - 132\"\nstage 200 match pass\nrule \"Additions - Windows Security - 201\"\nrule \"Additions - Windows Security - 202\"\nstage 210 match pass\nrule \"Additions - Windows Security - 211\"\nstage 220 match either\nrule \"Additions - Windows Security - 221\"\nrule \"Additions - Windows Security - 222\"\nrule \"Additions - Windows Security - 223\"\nrule \"Additions - Windows Security - 224\"\nend"},"connected_streams":[{"@type":"string","@value":"118c4c49-868e-4b7b-bf68-94e25f84af11"}]},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"8aa9a0d7-63a1-408d-b842-37fb4d80ade7","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 202"},"description":{"@type":"string","@value":"Determining whether a logoff is related to a Remote Session and setting values accordingly"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 202\"\nwhen\n    has_field(\"gim_event_type\")\n    && array_contains($message.gim_event_type,\"logoff\") \n    && to_string($message.event_outcome) == \"success\"  \n    && lookup_has_value(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    set_field(\"application_name\",\"windows_rdp\"); \n    set_field(\"windows_logon_type\", 10);\n    set_field(\"windows_logon_type_description\", \"RemoteInteractive Logon\");\n    set_field(\"gim_tags\", string_array_add(to_list($message.gim_tags), \"remote_access\"));\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"2423a3a0-de20-47a9-8904-58c7339b0576","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 221"},"description":{"@type":"string","@value":"Collecting RDP Logoffs and removing them from MongoDB"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 221\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && array_contains($message.gim_event_type,\"logoff\") \n    && to_string($message.event_outcome) == \"success\"  \n    && lookup_has_value(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    lookup_clear_key(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id)\n    );\n    \n    // set_field(\"Pipeline\",\"Additions - Windows Security - 221\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"3fcf4963-1129-41c5-a26a-d7d81aa1661c","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 131"},"description":{"@type":"string","@value":"Removing disconnected Sessions without Token Elevation from Inactive Sessions Table"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 131\"\nwhen\n    has_field(\"gim_event_type\")\n    && has_field(\"user_session_id\")\n    && array_contains($message.gim_event_type,\"session reconnect\")\n    && to_string($message.event_outcome) == \"success\"\n    && lookup_has_value(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let rdp_user_collection = lookup_remove_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"inactive_rdp_sessions\", \n        value: [to_string($message.user_session_id)]\n    );\n    \n    let rdp_session_status = lookup_add_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions\", \n        value: [to_string($message.user_session_id)]\n    );\n    \n    set_field(\"Pipeline\", \"Additions - Windows Security - 131\");\n\nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"ae554812-ba55-4c58-8816-8f70ce4e93da","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 040 - W"},"description":{"@type":"string","@value":"Add \"windows_elevated_token\" to \"Yes\" on messages containing field \"winlogbeat_winlog_event_data_ElevatedToken\" equals \"%%1842\" - WINLOGBEAT"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 040 - W\"\n\nwhen\n    to_string($message.winlogbeat_winlog_event_data_ElevatedToken) == \"%%1842\"\n    \nthen\n    set_field(\"windows_elevated_token\", \"Yes\");\n    \n    // debug\n    // set_field(\"Pipeline\", \"Additions - Windows Security - 040\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"4cc7659a-ad8b-4251-b749-65375e61c44d","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 062"},"description":{"@type":"string","@value":"Add \"gim_tags\" on Logs with \"windows_session_name\" equals \"windows_rdp\""},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 062\"\n\nwhen\n    to_string($message.windows_session_name) == \"windows_rdp\" \n    && NOT array_contains(to_list($message.gim_tags), \"remote_access\") \n    \nthen\n    set_field(\"gim_tags\", string_array_add(to_list($message.gim_tags), \"remote_access\"));\n    \n    // debug\n    set_field(\"Pipeline\", \"Additions - Windows Security - 062\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"85e35b84-cd26-4dc9-aeff-9070e45b37d8","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 224"},"description":{"@type":"string","@value":"Remove \"user_session_id\" from inactive RDP sessions (Hygiene)"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 224\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && array_contains($message.gim_event_type,\"logoff\") \n    && to_string($message.event_outcome) == \"success\"  \n    && lookup_string_list_contains(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"inactive_rdp_sessions\",\n        value: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let rdp_user_collection = lookup_remove_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"inactive_rdp_sessions\", \n        value: [to_string($message.user_session_id)]\n    );\n\n    //set_field(\"Pipeline\",\"Additions - Windows Security - 224\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"f26f3c1b-f16a-4389-ad8c-f5ce4fd1b86a","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 061"},"description":{"@type":"string","@value":"Add \"application_name\" on Logs with \"windows_logon_type\" equals \"10\""},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 061\"\n\nwhen\n    to_long($message.windows_logon_type) == 10\n    \nthen\n    set_field(\"application_name\", \"windows_rdp\");\n\n    // debug\n    // set_field(\"Pipeline\", \"Additions - Windows Security - 061\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"8ae00abe-4b3f-4ba2-b096-4cf65de960f1","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 001"},"description":{"@type":"string","@value":"Filter Logs with \"gim_event_category\" equals \"authentication\" and add field \"windows_elevated_token\" equals \"No\""},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 001\"\n\nwhen\n    array_contains(to_list($message.gim_event_subcategory), \"authentication.logon\")\n    || array_contains(to_list($message.gim_event_subcategory), \"authentication.logoff\")\n    \nthen\n    set_field(\"windows_elevated_token\", \"No\");\n    //set_field(\"Pipeline\", \"Additions - Windows Security - 001\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"9a8aa4ca-72ac-46c0-98cd-487bb7c0e6e9","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 065"},"description":{"@type":"string","@value":"Add \"source_hostname\" based on DNS reverse lookup"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 065\"\n\nwhen\n    has_field(\"source_ip\")\n    && array_contains(to_list($message.gim_tags), \"remote_access\") \n    \nthen\n    //let sourcehostname = lookup_value(\"windows-rdp-monitoring-source-hostnames\", to_string($message.source_ip));\n    let sourcehostname = regex_replace(value: to_string(lookup_value(\"windows-rdp-monitoring-source-hostnames\", to_string($message.source_ip))), pattern: \"(^.*)\\\\.\", replacement: \"$1\");\n    set_field(\"source_hostname\", sourcehostname);\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"7e848b91-7a62-4333-8645-85fcfaa69060","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 121"},"description":{"@type":"string","@value":"Removing disconnected Sessions without Token Elevation from Active Sessions Table"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 121\"\nwhen\n    has_field(\"gim_event_type\")\n    && has_field(\"user_session_id\")\n    && array_contains($message.gim_event_type,\"session disconnect\")\n    && to_string($message.event_outcome) == \"success\"\n    && to_string($message.windows_elevated_token) == \"No\"\n    && lookup_has_value(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let rdp_user_collection = lookup_remove_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions\", \n        value: [to_string($message.user_session_id)]\n    );\n    \n    let rdp_session_status = lookup_add_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"inactive_rdp_sessions\", \n        value: [to_string($message.user_session_id)]\n    );\n    \n    set_field(\"Pipeline\", \"Additions - Windows Security - 121\");\n\nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"6b5ed7b0-61cb-45f4-b0c7-462cbbc187b3","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 112"},"description":{"@type":"string","@value":"Collecting RDP Logins with Token Elevation and writing them to MongoDB"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 112\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && has_field(\"gim_tags\")\n    && has_field(\"user_session_id\")\n    && array_contains($message.gim_tags,\"remote_access\")\n    && array_contains($message.gim_event_type,\"logon\")\n    && to_string($message.event_outcome) == \"success\"\n    && to_string($message.windows_elevated_token) == \"Yes\"\n    \nthen\n    let rdp_user = lookup_set_value(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id),\n        value: to_string($message.timestamp)\n    );\n    \n    let rdp_user_collection = lookup_add_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions_elevated\", \n        value: [to_string($message.user_session_id)]\n    );\n    \n    set_field(\"Pipeline\", \"Additions - Windows Security - 112\");\n\nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"f7b40352-3203-41b4-bb69-47b4c2130bc6","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 222"},"description":{"@type":"string","@value":"Remove \"user_session_id\" from active RDP sessions"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 222\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && array_contains($message.gim_event_type,\"logoff\") \n    && to_string($message.event_outcome) == \"success\"  \n    && lookup_string_list_contains(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions\",\n        value: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let rdp_user_collection = lookup_remove_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions\", \n        value: [to_string($message.user_session_id)]\n    );\n\n    //set_field(\"Pipeline\",\"Additions - Windows Security - 222\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"e1a7b3d3-2fe9-4235-b66d-f19d449cae5f","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 042 - W"},"description":{"@type":"string","@value":"Add \"windows_logon_type\" on messages containing field \"winlogbeat_winlog_event_data_LogonType\" - WINLOGBEAT"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 042 - W\"\n\nwhen\n    has_field(\"winlogbeat_winlog_event_data_LogonType\")\n    \nthen\n    set_field(\"windows_logon_type\", to_long($message.winlogbeat_winlog_event_data_LogonType));\n    set_field(\"windows_logon_type_description\", \"RemoteInteractive Logon\");\n    \n    // debug\n    //set_field(\"Pipeline\", \"Additions - Windows Security - 042\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"d581fcf8-0ca8-48c4-bee2-42b75b9d9d39","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 132"},"description":{"@type":"string","@value":"Removing disconnected Sessions with Token Elevation from Inactive Sessions Table"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 132\"\nwhen\n    has_field(\"gim_event_type\")\n    && has_field(\"user_session_id\")\n    && array_contains($message.gim_event_type,\"session reconnect\")\n    && to_string($message.event_outcome) == \"success\"\n    && to_string($message.windows_elevated_token) == \"Yes\"\n    && lookup_has_value(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let rdp_user_collection = lookup_remove_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"inactive_rdp_sessions_elevated\", \n        value: [to_string($message.user_session_id)]\n    );\n    \n    let rdp_session_status = lookup_add_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions_elevated\", \n        value: [to_string($message.user_session_id)]\n    );\n    \n    set_field(\"Pipeline\", \"Additions - Windows Security - 131\");\n\nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"bcb41c55-8258-483e-a928-776b6c965a39","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 211"},"description":{"@type":"string","@value":"Calculating Session Duration based on Logoff Time and adding the result in Fields"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 211\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && has_field(\"user_session_id\")\n    && array_contains($message.gim_event_type,\"logoff\")\n    && to_string($message.event_outcome) == \"success\" \n    && lookup_has_value(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let session_login_time = list_get(lookup_string_list(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ),0);\n    \n    let login_time = to_long(parse_date(\n        value: to_string(session_login_time),\n        pattern: \"yyyy-MM-dd'T'HH:mm:ss.SSSZ\",\n        locale: \"de_DE\").millis);\n        \n    let current_time = to_long(parse_date(\n        value: to_string(now(timezone:\"Europe/Berlin\")),\n        pattern: \"yyyy-MM-dd'T'HH:mm:ss.SSSZ\",\n        locale: \"de_DE\").millis);\n    \n    let session_duration = current_time - login_time;\n    \n    set_field(\"session_duration_milliseconds\", session_duration);\n    set_field(\"session_duration_seconds\", session_duration/1000);\n    set_field(\"session_duration_minutes\", session_duration/1000/60);\n    set_field(\"session_duration_hours\", session_duration/1000/60/60); \n    \n    set_field(\"Pipeline\",\"Additions - Windows Security - 211\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"74f6d9b2-5d70-49c5-bfb1-af963c8415d4","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 044 - W"},"description":{"@type":"string","@value":"Add \"windows_session_name\" on messages containing field \"winlogbeat_winlog_event_data_SessionName\" - WINLOGBEAT"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 044 - W\"\n\nwhen\n    NOT has_field(\"windows_logon_type\")\n    AND has_field(\"winlogbeat_winlog_event_data_SessionName\")\n    \nthen\n    let field = regex_replace(\n        value: to_string($message.winlogbeat_winlog_event_data_SessionName), \n        pattern: \"RDP-Tcp\\\\#\\\\d+\",\n        replacement: \"windows_rdp\"\n        );\n    \n    set_field(\"windows_session_name\", field);\n    \n    // debug\n    set_field(\"Pipeline\", \"Additions - Windows Security - 044\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"b15eec6f-8184-417d-89dc-31e3224e87d4","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 044 - N"},"description":{"@type":"string","@value":"Add \"windows_session_name\" on messages containing field \"SessionName\"  - NXLOG"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 044 - N\"\n\nwhen\n    NOT has_field(\"windows_logon_type\")\n    AND has_field(\"SessionName\")\n    \nthen\n    let field = regex_replace(\n        value: to_string($message.SessionName), \n        pattern: \"RDP-Tcp\\\\#\\\\d+\",\n        replacement: \"windows_rdp\"\n        );\n    \n    set_field(\"windows_session_name\", field);\n    \n    // debug\n    // set_field(\"Pipeline\", \"Additions - Windows Security - 044\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"2bc8104a-a5f7-450e-b920-7e827b1c4c71","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 064"},"description":{"@type":"string","@value":"Add \"windows_elevated_token\" to \"Yes\" on messages where  Token Elevation is documented in the Lookup Table"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 064\"\n\nwhen\n    to_string($message.windows_session_name) == \"windows_rdp\"\n    && to_string($message.windows_elevated_session) == \"No\"\n    && lookup_string_list_contains(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions_elevated\", \n        value: [to_string($message.user_session_id)]\n    ) == true\nthen\n    set_field(\"windows_elevated_token\", \"Yes\");\n    \n    // debug\n    // set_field(\"Pipeline\", \"Additions - Windows Security - 064\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"6968d192-ca41-4d1f-af4a-8fe9d74e4baf","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 223"},"description":{"@type":"string","@value":"Remove \"user_session_id\" from active elevated RDP sessions"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 223\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && array_contains($message.gim_event_type,\"logoff\") \n    && to_string($message.event_outcome) == \"success\"  \n    && lookup_string_list_contains(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions_elevated\",\n        value: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let rdp_user_collection = lookup_remove_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions_elevated\", \n        value: [to_string($message.user_session_id)]\n    );\n\n    //set_field(\"Pipeline\",\"Additions - Windows Security - 223\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"02d02b7d-ed47-4836-8c66-f6e3e7b854f4","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 042 - N"},"description":{"@type":"string","@value":"Add \"windows_logon_type\" on messages containing field \"LogonType\" - NXLOG"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 042 - N\"\n\nwhen\n    has_field(\"LogonType\")\n    \nthen\n    set_field(\"windows_logon_type\", to_long($message.LogonType));\n    set_field(\"windows_logon_type_description\", \"RemoteInteractive Logon\");\n    \n    // debug\n    // set_field(\"Pipeline\", \"Additions - Windows Security - 042\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"f72de4bb-c1b8-4bbc-948e-6740ad608133","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 122"},"description":{"@type":"string","@value":"Removing disconnected Sessions with Token Elevation from Active Sessions Table"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 122\"\nwhen\n    has_field(\"gim_event_type\")\n    && has_field(\"user_session_id\")\n    && array_contains($message.gim_event_type,\"session disconnect\")\n    && to_string($message.event_outcome) == \"success\"\n    && to_string($message.windows_elevated_token) == \"Yes\"\n    && lookup_has_value(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let rdp_user_collection = lookup_remove_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions_elevated\", \n        value: [to_string($message.user_session_id)]\n    );\n    \n    let rdp_session_status = lookup_add_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"inactive_rdp_sessions_elevated\", \n        value: [to_string($message.user_session_id)]\n    );\n    \n    set_field(\"Pipeline\",\"Windows_121\");\n\nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"d02033ac-aad3-4b5a-9160-fe3053da172a","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 111"},"description":{"@type":"string","@value":"Collecting RDP Logins without Token Elevation and writing them to MongoDB"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 111\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && has_field(\"gim_tags\")\n    && has_field(\"user_session_id\")\n    && array_contains($message.gim_tags,\"remote_access\")\n    && array_contains($message.gim_event_type,\"logon\")\n    && to_string($message.event_outcome) == \"success\"\n    && to_string($message.windows_elevated_token) == \"No\"\n    \nthen\n    let rdp_user = lookup_set_value(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id),\n        value: to_string($message.timestamp)\n    );\n    \n    let rdp_user_collection = lookup_add_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions\", \n        value: [to_string($message.user_session_id)]\n    );\n    \n    set_field(\"Pipeline\",\"Additions - Windows Security - 111\");\n\nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"82b30dd6-a02f-4fc9-b4e6-c745817b9f79","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 040 - N"},"description":{"@type":"string","@value":"Add \"windows_elevated_token\" to \"Yes\" on messages containing field \"ElevatedToken\" equals \"%%1842\" - NXLOG"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 040 - N\"\n\nwhen\n    to_string($message.ElevatedToken) == \"%%1842\"\n    \nthen\n    set_field(\"windows_elevated_token\", \"Yes\");\n    \n    // debug\n    // set_field(\"Pipeline\", \"Additions - Windows Security - 040\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"4c02047b-a74d-4ca5-b489-843c9173b1bd","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 225"},"description":{"@type":"string","@value":"Remove \"user_session_id\" from inactive elevated RDP sessions (Hygiene)"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 225\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && array_contains($message.gim_event_type,\"logoff\") \n    && to_string($message.event_outcome) == \"success\"  \n    && lookup_string_list_contains(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"inactive_rdp_sessions_elevated\",\n        value: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let rdp_user_collection = lookup_remove_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"inactive_rdp_sessions_elevated\", \n        value: [to_string($message.user_session_id)]\n    );\n\n    //set_field(\"Pipeline\",\"Additions - Windows Security - 225\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"cb867378-4da8-4e35-9da8-b8e7c143dca9","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Additions - Windows Security - 201"},"description":{"@type":"string","@value":"Determining whether a logoff is related to a Token Elevation and setting \"windows_elevated_token\" accordingly"},"source":{"@type":"string","@value":"rule \"Additions - Windows Security - 201\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && array_contains($message.gim_event_type,\"logoff\") \n    && to_string($message.event_outcome) == \"success\"  \n    && lookup_string_list_contains(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions_elevated\",\n        value: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    set_field(\"windows_elevated_token\", \"Yes\");\n    set_field(\"Pipeline\",\"Additions - Windows Security - 201\");\n    \nend"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"118c4c49-868e-4b7b-bf68-94e25f84af11","type":{"name":"stream_title","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Illuminate:Windows Security Event Log Messages"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"000000000000000000000002","type":{"name":"stream_title","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"All events"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]},{"id":"000000000000000000000003","type":{"name":"stream_title","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"All system events"}},"constraints":[{"type":"server-version","version":">=7.0.4+ac94792"}]}]}