{
  "v": "1",
  "id": "d092b386-cac5-49f5-818d-ebc93795ff5a",
  "rev": 2,
  "name": "Community: Windows Addons Pack",
  "summary": "Community: Windows Addons Pack",
  "description": "Community: Windows Addons Pack",
  "vendor": "Graylog Community",
  "url": "https://github.com/fjagwitz/Graylog-Cookbooks",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "dashboard",
        "version": "2"
      },
      "id": "cda6cb79-56d3-49ad-bfec-e56cb3fb564e",
      "data": {
        "summary": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP"
        },
        "search": {
          "queries": [
            {
              "id": "a9efa56f-40d1-488b-82e0-0a1b2bfa1f03",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "user_session_id:$rdp_is$"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "ac71d79c-624e-4f67-8f94-4166f041f68a"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "card",
                      "id": "Connection Source",
                      "field": "user_session_id"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "28c06fa1-a2e6-42de-98c1-4a99764b74a2",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:source_ip AND _exists_:destination_ip AND network_application:rdp"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "sum",
                      "id": "Data Volume",
                      "field": "source_bytes_sent"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "source_ip",
                        "destination_ip"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "9966fa47-a2b9-442e-bb26-56e90708de79",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "gim_tags:remote_access AND gim_event_subcategory:authentication.logoff AND user_name:$account$"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "card",
                      "id": "Different Connections",
                      "field": "event_source"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "user_name"
                      ],
                      "limit": 25,
                      "skip_empty_values": true
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "cbd6efcb-4402-4486-ab75-85b28f42b01c",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "series",
                      "field": "card(event_source)",
                      "direction": "Descending"
                    }
                  ]
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": null,
                  "timerange": {
                    "from": 2592000,
                    "type": "relative"
                  },
                  "streams": [
                    "000000000000000000000002"
                  ],
                  "filter": null,
                  "type": "events",
                  "stream_categories": [],
                  "id": "d51feec8-9b76-47e1-a1a3-db282489d8ee",
                  "filters": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:gim_tags AND gim_event_type:\"network connection\" AND NOT gim_tags:destination_is_internal AND gim_tags:source_is_internal AND event_action:blocked AND network_application:rdp"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "card",
                      "id": "card(source_port)",
                      "field": "source_port"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "940db656-6811-48d7-97ec-bec0b6efa138",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:source_ip AND _exists_:destination_ip AND network_application:rdp"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "sum",
                      "id": "Data Volume",
                      "field": "destination_bytes_sent"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "source_ip",
                        "destination_ip"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "86934f75-3d47-4c92-8486-ace481b6f9a0",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "series",
                      "field": "sum(destination_bytes_sent)",
                      "direction": "Descending"
                    }
                  ]
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:gim_tags AND gim_event_type:\"network connection\" gim_tags:destination_is_internal AND event_action:allowed AND network_application:rdp AND NOT gim_tags:source_is_internal AND NOT destination_bytes_sent:<=1500"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "card",
                      "id": "Connection Source",
                      "field": "source_port"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "960acbfe-de14-48ed-a34b-b5645d52a0c3",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "gim_tags:remote_access AND gim_event_subcategory:authentication.logoff AND user_session_duration_minutes:>$sessionDuration$ AND user_name:$account$"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "ac71d79c-624e-4f67-8f94-4166f041f68a"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "card",
                      "id": "Connection Source",
                      "field": "user_name"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "5f76bd60-2add-4e38-ab64-b836eaa35ba6",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:gim_tags AND gim_event_type:\"network connection\" gim_tags:destination_is_internal AND event_action:allowed AND network_application:rdp AND NOT gim_tags:source_is_internal AND destination_bytes_sent:>1500"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "source_geo_country",
                        "source_geo_city"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    },
                    {
                      "type": "values",
                      "fields": [
                        "source_ip",
                        "source_port"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    },
                    {
                      "type": "values",
                      "fields": [
                        "destination_ip",
                        "event_action"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "26ec6434-68a3-429e-9f61-4ce2cd4f44a1",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "gim_event_type:\"session disconnect\""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "ac71d79c-624e-4f67-8f94-4166f041f68a"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "card",
                      "id": "Connection Source",
                      "field": "user_session_id"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "b875d467-481a-4074-adbd-80ecf1e6b1fa",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:gim_tags AND gim_event_type:\"network connection\" AND gim_tags:source_is_internal AND event_action:allowed AND network_application:rdp AND NOT gim_tags:destination_is_internal AND NOT destination_bytes_sent:<=1500"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "card",
                      "id": "card(source_port)",
                      "field": "source_port"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "fd1f214f-dea8-42c3-a8e3-971b4fd2c30f",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "gim_tags:remote_access AND gim_event_subcategory:authentication.logoff AND user_session_duration_minutes:>$sessionDuration$ AND user_name:$account$"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "user_name",
                        "source_hostname",
                        "destination_hostname",
                        "source_ip",
                        "destination_ip"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "2acb0d46-d1e7-46cb-bbec-4bb63732ffb8",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                }
              ]
            },
            {
              "id": "67b924dc-d190-4163-8a37-b77bda3e7362",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "user_session_id:($rdp_as$ OR $rdp_is$)"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "ac71d79c-624e-4f67-8f94-4166f041f68a"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "card",
                      "id": "Different Connections",
                      "field": "event_source"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "user_name"
                      ],
                      "limit": 25,
                      "skip_empty_values": true
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "de12e971-fd7f-4369-8158-4f5571b23b74",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "series",
                      "field": "card(event_source)",
                      "direction": "Descending"
                    }
                  ]
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:(user_session_id AND gim_event_type) AND user_session_id:$rdp_is$ AND gim_event_type:\"session disconnect\""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "ac71d79c-624e-4f67-8f94-4166f041f68a"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "card",
                      "id": "card(user_session_id)",
                      "field": "user_session_id"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "eca4bffe-14a8-4fd6-9a23-fff859a66700",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "user_session_id:$rdp_is$ AND gim_event_type:\"session disconnect\" AND _exists_:(user_name AND event_source AND source_ip AND gim_event_type) "
                  },
                  "name": "chart",
                  "timerange": {
                    "range": 0,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "ac71d79c-624e-4f67-8f94-4166f041f68a"
                  ],
                  "row_limit": null,
                  "series": [],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "user_name",
                        "source_ip",
                        "source_hostname",
                        "destination_hostname",
                        "destination_ip"
                      ],
                      "limit": 25,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "f726a1e3-8171-4191-bd4c-27cac6c715c6",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "user_session_id:$rdp_as$ AND _exists_:(user_name AND event_source AND source_ip AND gim_event_type) AND gim_tags:remote_access"
                  },
                  "name": "chart",
                  "timerange": {
                    "range": 0,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "ac71d79c-624e-4f67-8f94-4166f041f68a"
                  ],
                  "row_limit": null,
                  "series": [],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "user_name",
                        "source_ip",
                        "source_hostname",
                        "destination_hostname",
                        "destination_ip"
                      ],
                      "limit": 25,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "02eddf9a-5d09-4fd8-a60c-b5d6623b3fbf",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:(user_session_duration AND user_name)"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "min",
                      "id": "Session Duration",
                      "field": "user_session_duration"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "user_name"
                      ],
                      "limit": 25,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "b06d3c6e-1dcb-4acc-b758-0720de0f8a4f",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "series",
                      "field": "min(user_session_duration)",
                      "direction": "Ascending"
                    }
                  ]
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:(user_session_duration AND user_name) "
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "ac71d79c-624e-4f67-8f94-4166f041f68a"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "max",
                      "id": "Session Duration",
                      "field": "user_session_duration"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "user_name"
                      ],
                      "limit": 25,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "b08b20b3-70db-46da-912e-646ee2f0e1e4",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "series",
                      "field": "max(user_session_duration)",
                      "direction": "Descending"
                    }
                  ]
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "user_session_id:$rdp_as$"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 604800,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "ac71d79c-624e-4f67-8f94-4166f041f68a"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "card",
                      "id": "card(user_session_id)",
                      "field": "user_session_id"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "600d1d8a-de01-476b-bcbd-7e4ab04db8dc",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:(user_session_duration AND user_name AND event_source) "
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 2592000,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "max",
                      "id": "Longest Session's Duration",
                      "field": "user_session_duration"
                    },
                    {
                      "type": "min",
                      "id": "Shortest Session's Duration",
                      "field": "user_session_duration"
                    },
                    {
                      "type": "card",
                      "id": "Different Hosts",
                      "field": "destination_hostname"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "user_name"
                      ],
                      "limit": 150,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "8ef951b7-4c28-4152-aeee-04f770ff974c",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "series",
                      "field": "card(destination_hostname)",
                      "direction": "Descending"
                    }
                  ]
                }
              ]
            }
          ],
          "parameters": [
            {
              "name": "sessionDuration",
              "title": "duration",
              "description": "Session Duration in Minutes",
              "optional": false,
              "binding": {
                "value": "",
                "type": "value"
              },
              "type": "value-parameter-v1",
              "data_type": "any",
              "default_value": "480"
            },
            {
              "name": "account",
              "title": "investigate",
              "description": "Name of the User",
              "optional": false,
              "binding": {
                "value": "",
                "type": "value"
              },
              "type": "value-parameter-v1",
              "data_type": "any",
              "default_value": "*"
            },
            {
              "optional": false,
              "lookup_table": "Community: rdp-logins",
              "name": "rdp_as",
              "data_type": "any",
              "default_value": "none",
              "title": "online",
              "type": "lut-parameter-v1",
              "description": "rdp_as",
              "key": "rdp_as"
            },
            {
              "optional": false,
              "lookup_table": "Community: rdp-logins",
              "name": "rdp_is",
              "data_type": "any",
              "default_value": "none",
              "title": "offline",
              "type": "lut-parameter-v1",
              "description": "rdp_is",
              "key": "rdp_is"
            }
          ],
          "requires": {
            "parameters": {
              "name": "Graylog Enterprise",
              "author": "Graylog, Inc.",
              "url": "https://www.graylog.org/enterprise",
              "version": "3.1.0",
              "description": "Graylog Enterprise",
              "unique_id": "org.graylog.plugins.enterprise.EnterprisePlugin"
            }
          },
          "owner": "eval-admin",
          "created_at": "2026-02-20T19:16:21.198Z"
        },
        "created_at": "2024-06-14T17:25:26.453Z",
        "requires": {
          "parameters": {
            "name": "Graylog Enterprise",
            "author": "Graylog, Inc.",
            "url": "https://www.graylog.org/enterprise",
            "version": "3.1.0",
            "description": "Graylog Enterprise",
            "unique_id": "org.graylog.plugins.enterprise.EnterprisePlugin"
          }
        },
        "state": {
          "67b924dc-d190-4163-8a37-b77bda3e7362": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "RDP User Session Insights"
              },
              "widget": {
                "a2691484-fbb3-444a-a39f-f7ab24c84bd9": "Inactive RDP Sessions",
                "05365196-8255-4f47-b011-6f0d75ef3f95": "Inactive RDP Sessions List",
                "de50b0aa-8383-4c6d-8c92-3c23a53c7644": "Messages for user_name:bachte AND event_source:WIN198104.lab.fritzdata.de AND source_ip:172.16.112.102 AND gim_event_type:logon",
                "d380021e-9c51-4510-9cb8-1d7b1b671182": "Finished RDP Session Durations by Machine (detailed)",
                "fe066d7c-3796-4e45-bebf-43ca6b9f3557": "RDP Session Durations Ascending",
                "a4d97060-cc95-4131-b81c-2f072dca2900": "RDP Session Durations Descending",
                "8955d53a-217b-4ce1-8f99-53ffc016ecb6": "Finished RDP Session Durations by User (detailed) (copy)",
                "1e7d0e2d-f1a5-4c91-853b-09152a19d88b": "Messages for user_name:bachte AND event_source:WIN198104.lab.fritzdata.de AND source_ip:172.16.112.102 AND gim_event_type:logon",
                "d4cdae48-bf0a-4f6b-a9b1-0749264db0ce": "Total Sessions (last 7 days, except Outbound)",
                "49c73f29-3f79-4f5b-8cdd-c3b9301433a5": "Machines with inactive RDP Connections",
                "2f49c4b1-758f-468f-b943-da6ffab51d84": "Finished RDP Session Durations by User (detailed)",
                "943c52bc-9742-4fae-9535-1fd5989cec35": "Messages for user_name:bachte AND event_source:WIN198104.lab.fritzdata.de",
                "670795db-b8ec-4215-993c-1f5f6335dc6f": "Sessions to Machines by User (Current)",
                "f8637d4b-34b9-470d-bbbc-ff28fdc03bf3": "Active RDP Sessions",
                "b5d43b02-d732-4afe-80cb-4f24ef05f061": "Finished RDP Session Durations by Machine (detailed)",
                "d9f49fa3-a1ca-496b-abc0-a95702f2e4c0": "Finished RDP Session Durations by Machine (detailed)",
                "fd4dd9f6-a69b-4180-a8a5-9739a1b8c844": "Active RDP Sessions List"
              }
            },
            "widgets": [
              {
                "config": {
                  "visualization": "bar",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 25,
                  "row_pivots": [
                    {
                      "fields": [
                        "user_name"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 25,
                        "skip_empty_values": true
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Different Connections",
                        "thresholds": [
                          {
                            "color": "#bab36d",
                            "name": "Baseline for normal behaviour",
                            "value": 1
                          }
                        ]
                      },
                      "function": "card(event_source)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "barmode": "group",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "series",
                      "field": "card(event_source)",
                      "direction": "Descending"
                    }
                  ]
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "user_session_id:($rdp_as$ OR $rdp_is$)"
                },
                "context": null,
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [
                  "ac71d79c-624e-4f67-8f94-4166f041f68a"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "670795db-b8ec-4215-993c-1f5f6335dc6f",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "table",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 25,
                  "row_pivots": [
                    {
                      "fields": [
                        "user_name",
                        "source_ip",
                        "source_hostname",
                        "destination_hostname",
                        "destination_ip"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 25
                      }
                    }
                  ],
                  "series": [],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": [],
                    "show_row_numbers": true
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "user_session_id:$rdp_is$ AND gim_event_type:\"session disconnect\" AND _exists_:(user_name AND event_source AND source_ip AND gim_event_type) "
                },
                "context": null,
                "timerange": {
                  "range": 0,
                  "type": "relative"
                },
                "streams": [
                  "ac71d79c-624e-4f67-8f94-4166f041f68a"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "05365196-8255-4f47-b011-6f0d75ef3f95",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "numeric",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": null,
                        "thresholds": []
                      },
                      "function": "card(user_session_id)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": false,
                    "trend_preference": "NEUTRAL"
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:(user_session_id AND gim_event_type) AND user_session_id:$rdp_is$ AND gim_event_type:\"session disconnect\""
                },
                "context": null,
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [
                  "ac71d79c-624e-4f67-8f94-4166f041f68a"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "a2691484-fbb3-444a-a39f-f7ab24c84bd9",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "numeric",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": null,
                        "thresholds": []
                      },
                      "function": "card(user_session_id)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": false,
                    "trend_preference": "NEUTRAL"
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "user_session_id:$rdp_as$"
                },
                "context": null,
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [
                  "ac71d79c-624e-4f67-8f94-4166f041f68a"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "f8637d4b-34b9-470d-bbbc-ff28fdc03bf3",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "table",
                  "units": {
                    "session_duration_milliseconds": {
                      "unit_type": "time",
                      "abbrev": "ms"
                    },
                    "user_session_duration": {
                      "unit_type": "time",
                      "abbrev": "ms"
                    }
                  },
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 150,
                  "row_pivots": [
                    {
                      "fields": [
                        "user_name"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 150,
                        "skip_empty_values": false
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Longest Session's Duration",
                        "thresholds": []
                      },
                      "function": "max(user_session_duration)"
                    },
                    {
                      "config": {
                        "name": "Shortest Session's Duration",
                        "thresholds": []
                      },
                      "function": "min(user_session_duration)"
                    },
                    {
                      "config": {
                        "name": "Different Hosts",
                        "thresholds": []
                      },
                      "function": "card(destination_hostname)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": [],
                    "show_row_numbers": true
                  },
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "series",
                      "field": "card(destination_hostname)",
                      "direction": "Descending"
                    }
                  ]
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:(user_session_duration AND user_name AND event_source) "
                },
                "context": null,
                "timerange": {
                  "from": 2592000,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "2f49c4b1-758f-468f-b943-da6ffab51d84",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "table",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 25,
                  "row_pivots": [
                    {
                      "fields": [
                        "user_name",
                        "source_ip",
                        "source_hostname",
                        "destination_hostname",
                        "destination_ip"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 25
                      }
                    }
                  ],
                  "series": [],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": [],
                    "show_row_numbers": true
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "user_session_id:$rdp_as$ AND _exists_:(user_name AND event_source AND source_ip AND gim_event_type) AND gim_tags:remote_access"
                },
                "context": null,
                "timerange": {
                  "range": 0,
                  "type": "relative"
                },
                "streams": [
                  "ac71d79c-624e-4f67-8f94-4166f041f68a"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "fd4dd9f6-a69b-4180-a8a5-9739a1b8c844",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "bar",
                  "units": {
                    "session_duration_milliseconds": {
                      "unit_type": "time",
                      "abbrev": "ms"
                    },
                    "user_session_duration": {
                      "unit_type": "time",
                      "abbrev": "ms"
                    }
                  },
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 25,
                  "row_pivots": [
                    {
                      "fields": [
                        "user_name"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 25,
                        "skip_empty_values": false
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Session Duration",
                        "thresholds": []
                      },
                      "function": "max(user_session_duration)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "barmode": "group",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "series",
                      "field": "max(user_session_duration)",
                      "direction": "Descending"
                    }
                  ]
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:(user_session_duration AND user_name) "
                },
                "context": null,
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [
                  "ac71d79c-624e-4f67-8f94-4166f041f68a"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "a4d97060-cc95-4131-b81c-2f072dca2900",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "bar",
                  "units": {
                    "session_duration_milliseconds": {
                      "unit_type": "time",
                      "abbrev": "ms"
                    },
                    "user_session_duration": {
                      "unit_type": "time",
                      "abbrev": "ms"
                    }
                  },
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 25,
                  "row_pivots": [
                    {
                      "fields": [
                        "user_name"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 25,
                        "skip_empty_values": false
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Session Duration",
                        "thresholds": []
                      },
                      "function": "min(user_session_duration)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "barmode": "group",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "series",
                      "field": "min(user_session_duration)",
                      "direction": "Ascending"
                    }
                  ]
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:(user_session_duration AND user_name)"
                },
                "context": null,
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "fe066d7c-3796-4e45-bebf-43ca6b9f3557",
                "filters": [],
                "description": null
              }
            ],
            "widget_mapping": {
              "fd4dd9f6-a69b-4180-a8a5-9739a1b8c844": [
                "02eddf9a-5d09-4fd8-a60c-b5d6623b3fbf"
              ],
              "05365196-8255-4f47-b011-6f0d75ef3f95": [
                "f726a1e3-8171-4191-bd4c-27cac6c715c6"
              ],
              "2f49c4b1-758f-468f-b943-da6ffab51d84": [
                "8ef951b7-4c28-4152-aeee-04f770ff974c"
              ],
              "f8637d4b-34b9-470d-bbbc-ff28fdc03bf3": [
                "600d1d8a-de01-476b-bcbd-7e4ab04db8dc"
              ],
              "a4d97060-cc95-4131-b81c-2f072dca2900": [
                "b08b20b3-70db-46da-912e-646ee2f0e1e4"
              ],
              "a2691484-fbb3-444a-a39f-f7ab24c84bd9": [
                "eca4bffe-14a8-4fd6-9a23-fff859a66700"
              ],
              "fe066d7c-3796-4e45-bebf-43ca6b9f3557": [
                "b06d3c6e-1dcb-4acc-b758-0720de0f8a4f"
              ],
              "670795db-b8ec-4215-993c-1f5f6335dc6f": [
                "de12e971-fd7f-4369-8158-4f5571b23b74"
              ]
            },
            "positions": {
              "a4d97060-cc95-4131-b81c-2f072dca2900": {
                "col": 1,
                "row": 11,
                "height": 4,
                "width": 6
              },
              "fe066d7c-3796-4e45-bebf-43ca6b9f3557": {
                "col": 7,
                "row": 11,
                "height": 4,
                "width": 6
              },
              "fd4dd9f6-a69b-4180-a8a5-9739a1b8c844": {
                "col": 4,
                "row": 1,
                "height": 3,
                "width": 9
              },
              "05365196-8255-4f47-b011-6f0d75ef3f95": {
                "col": 4,
                "row": 4,
                "height": 3,
                "width": 9
              },
              "f8637d4b-34b9-470d-bbbc-ff28fdc03bf3": {
                "col": 1,
                "row": 1,
                "height": 3,
                "width": 3
              },
              "2f49c4b1-758f-468f-b943-da6ffab51d84": {
                "col": 1,
                "row": 15,
                "height": 4,
                "width": "Infinity"
              },
              "a2691484-fbb3-444a-a39f-f7ab24c84bd9": {
                "col": 1,
                "row": 4,
                "height": 3,
                "width": 3
              },
              "670795db-b8ec-4215-993c-1f5f6335dc6f": {
                "col": 1,
                "row": 7,
                "height": 4,
                "width": "Infinity"
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          },
          "a9efa56f-40d1-488b-82e0-0a1b2bfa1f03": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "Risk Indicators based on RDP"
              },
              "widget": {
                "7d2d075c-2f04-47e8-99c0-c79de07d93f0": "Active Admin Sessions (copy)",
                "5c1121b2-8430-4ff0-8614-4affb7550791": "Inactive Admin Sessions",
                "f9dec316-3f00-489b-89c7-40ff76d801df": "Reconnected Sessions",
                "bc5ac17c-2a4d-4aaf-aa6e-a4df87a2d247": "Inactive User Sessions",
                "af8f496f-7253-4fa5-b8da-1a960c313eb2": "Sent Data",
                "dda5f2c9-f66e-4175-acae-514d874e6870": "Total Admin Sessions (currently)",
                "abd7426e-b772-42c6-a2c0-bfc8ba7e6af4": "Outbound Connections (last 7 days)",
                "0f6225ff-be31-4a60-b879-52c62f34a728": "Inbound Connections (detailed)",
                "3b674578-bf39-4014-8d4b-21acb8551e5d": "Internal Connections (last 7 days)",
                "f9f61b72-30c7-4e6f-86e8-6fe11e4a29c8": "Active User Sessions",
                "38084aeb-50bf-424d-b6f5-1b36e27dd38b": "Idle Sessions (last 7 days)",
                "7b674c71-b784-45b8-a4cd-5b3032621b4a": "Long Running Sessions (detailed)",
                "be9d41e7-ba5e-43bc-831a-153580703e45": "Active Admin Sessions",
                "831a9582-46bf-4eb8-a26f-62f49b700033": "Long Running Sessions (last 7 days)",
                "52976920-8a8d-4e08-9686-01690c606790": "Messages for user_name:\"barbara taylor\" AND NOT _exists_:source_hostname",
                "08d4afa6-1b28-46fd-a0f5-33491ccb3ce2": "Number of different Session Targets per User",
                "dedb0945-02f1-498d-b3f3-015345145c2b": "Explanation",
                "9c5c7766-5891-4ced-81e4-b24259d8505b": "Messages for user_name:\"james martinez\"",
                "a70f0b91-1499-4deb-a3e1-c0bf4efc4dbc": "Sessions per Machine",
                "74c1719c-75b7-4306-a4ec-e68f290e4b51": "Messages for user_name:\"james martinez\"",
                "7bde3a49-84c9-48c5-a0f6-52c11b9b1bfa": "Idle Sessions (Current)",
                "c78ceec3-02b5-4d41-b2c3-4b19654ea1a9": "RDP Events (New)",
                "499d0df1-2c77-4d10-a1cf-4b3452bf997d": "Received Data",
                "a5f8c945-b155-44e5-98a9-94dfa6a3a184": "Users connecting to multiple Targets",
                "af1248ea-05d5-4dac-ab71-b7adb9b70e91": "Inbound Connections (last 7 days)",
                "05faf727-d9b1-45d7-9308-e5c16ffc748f": "Internal Connections (last 7 days)",
                "bc55e6d2-1345-457e-b128-9455c81dbf30": "Long Running Sessions (last 7 days)",
                "456d96b4-f553-4dd4-8522-1ec737e7fee1": "Failed Outbound Connection Attempts (last 7 days)",
                "4c10b93d-bdd7-4e21-8d25-790cc459da0e": "Number of different Session Targets per User (copy)",
                "a9bba84e-fb57-4a69-b27c-d939c9c93588": "Messages for user_name:\"barbara taylor\""
              }
            },
            "widgets": [
              {
                "config": {
                  "visualization": "table",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "user_name",
                        "source_hostname",
                        "destination_hostname",
                        "source_ip",
                        "destination_ip"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": [],
                    "show_row_numbers": true
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "gim_tags:remote_access AND gim_event_subcategory:authentication.logoff AND user_session_duration_minutes:>$sessionDuration$ AND user_name:$account$"
                },
                "context": null,
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "7b674c71-b784-45b8-a4cd-5b3032621b4a",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "table",
                  "units": {
                    "destination_bytes_sent": {
                      "unit_type": "size",
                      "abbrev": "b"
                    },
                    "source_bytes_sent": {
                      "unit_type": "size",
                      "abbrev": "b"
                    }
                  },
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "source_ip",
                        "destination_ip"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Data Volume",
                        "thresholds": []
                      },
                      "function": "sum(source_bytes_sent)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": [],
                    "show_row_numbers": true
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:source_ip AND _exists_:destination_ip AND network_application:rdp"
                },
                "context": null,
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "af8f496f-7253-4fa5-b8da-1a960c313eb2",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "numeric",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": null,
                        "thresholds": []
                      },
                      "function": "card(source_port)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": false,
                    "trend_preference": "NEUTRAL"
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:gim_tags AND gim_event_type:\"network connection\" AND gim_tags:source_is_internal AND event_action:allowed AND network_application:rdp AND NOT gim_tags:destination_is_internal AND NOT destination_bytes_sent:<=1500"
                },
                "context": null,
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "abd7426e-b772-42c6-a2c0-bfc8ba7e6af4",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "numeric",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": "Connection Source",
                        "thresholds": []
                      },
                      "function": "card(user_session_id)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": false,
                    "trend_preference": "NEUTRAL"
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "user_session_id:$rdp_is$"
                },
                "context": "",
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [
                  "ac71d79c-624e-4f67-8f94-4166f041f68a"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "7bde3a49-84c9-48c5-a0f6-52c11b9b1bfa",
                "filters": [],
                "description": "Sessions that have not been logged off but are still open"
              },
              {
                "config": {
                  "visualization": "numeric",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": null,
                        "thresholds": []
                      },
                      "function": "card(source_port)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": false,
                    "trend_preference": "NEUTRAL"
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:gim_tags AND gim_event_type:\"network connection\" AND NOT gim_tags:destination_is_internal AND gim_tags:source_is_internal AND event_action:blocked AND network_application:rdp"
                },
                "context": null,
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "456d96b4-f553-4dd4-8522-1ec737e7fee1",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "bar",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 25,
                  "row_pivots": [
                    {
                      "fields": [
                        "user_name"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 25,
                        "skip_empty_values": true
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Different Connections",
                        "thresholds": [
                          {
                            "color": "#bab36d",
                            "name": "Baseline for normal behaviour",
                            "value": 1
                          }
                        ]
                      },
                      "function": "card(event_source)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "barmode": "overlay",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "series",
                      "field": "card(event_source)",
                      "direction": "Descending"
                    }
                  ]
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "gim_tags:remote_access AND gim_event_subcategory:authentication.logoff AND user_name:$account$"
                },
                "context": null,
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "a5f8c945-b155-44e5-98a9-94dfa6a3a184",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "mode": "List",
                  "fields": [
                    "alert",
                    "event_definition_id",
                    "key",
                    "status",
                    "timestamp"
                  ],
                  "units": {},
                  "filters": [
                    {
                      "field": "status",
                      "value": [
                        "NEW"
                      ]
                    }
                  ],
                  "sort": {
                    "field": "timestamp",
                    "direction": "Descending"
                  }
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "context": null,
                "timerange": {
                  "from": 2592000,
                  "type": "relative"
                },
                "streams": [
                  "000000000000000000000002"
                ],
                "filter": null,
                "type": "events",
                "stream_categories": [],
                "id": "c78ceec3-02b5-4d41-b2c3-4b19654ea1a9",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "table",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "source_geo_country",
                        "source_geo_city"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    },
                    {
                      "fields": [
                        "source_ip",
                        "source_port"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    },
                    {
                      "fields": [
                        "destination_ip",
                        "event_action"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": [],
                    "show_row_numbers": true
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:gim_tags AND gim_event_type:\"network connection\" gim_tags:destination_is_internal AND event_action:allowed AND network_application:rdp AND NOT gim_tags:source_is_internal AND destination_bytes_sent:>1500"
                },
                "context": null,
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "0f6225ff-be31-4a60-b879-52c62f34a728",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "numeric",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": "Connection Source",
                        "thresholds": []
                      },
                      "function": "card(user_name)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": false,
                    "trend_preference": "NEUTRAL"
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "gim_tags:remote_access AND gim_event_subcategory:authentication.logoff AND user_session_duration_minutes:>$sessionDuration$ AND user_name:$account$"
                },
                "context": "",
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [
                  "ac71d79c-624e-4f67-8f94-4166f041f68a"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "831a9582-46bf-4eb8-a26f-62f49b700033",
                "filters": [],
                "description": "Long Running RDP Sessions (defined by \"duration\" Parameter)"
              },
              {
                "config": {
                  "visualization": "numeric",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": "Connection Source",
                        "thresholds": []
                      },
                      "function": "card(source_port)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": false,
                    "trend_preference": "NEUTRAL"
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:gim_tags AND gim_event_type:\"network connection\" gim_tags:destination_is_internal AND event_action:allowed AND network_application:rdp AND NOT gim_tags:source_is_internal AND NOT destination_bytes_sent:<=1500"
                },
                "context": null,
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "af1248ea-05d5-4dac-ab71-b7adb9b70e91",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "table",
                  "units": {
                    "destination_bytes_sent": {
                      "unit_type": "size",
                      "abbrev": "b"
                    }
                  },
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "source_ip",
                        "destination_ip"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Data Volume",
                        "thresholds": []
                      },
                      "function": "sum(destination_bytes_sent)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": [],
                    "show_row_numbers": true
                  },
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "series",
                      "field": "sum(destination_bytes_sent)",
                      "direction": "Descending"
                    }
                  ]
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:source_ip AND _exists_:destination_ip AND network_application:rdp"
                },
                "context": null,
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "499d0df1-2c77-4d10-a1cf-4b3452bf997d",
                "filters": [],
                "description": null
              },
              {
                "config": {
                  "visualization": "numeric",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": "Connection Source",
                        "thresholds": []
                      },
                      "function": "card(user_session_id)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": false,
                    "trend_preference": "NEUTRAL"
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "gim_event_type:\"session disconnect\""
                },
                "context": "",
                "timerange": {
                  "from": 604800,
                  "type": "relative"
                },
                "streams": [
                  "ac71d79c-624e-4f67-8f94-4166f041f68a"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "38084aeb-50bf-424d-b6f5-1b36e27dd38b",
                "filters": [],
                "description": "Sessions that have not been logged off but are still open"
              }
            ],
            "widget_mapping": {
              "af8f496f-7253-4fa5-b8da-1a960c313eb2": [
                "9966fa47-a2b9-442e-bb26-56e90708de79"
              ],
              "abd7426e-b772-42c6-a2c0-bfc8ba7e6af4": [
                "fd1f214f-dea8-42c3-a8e3-971b4fd2c30f"
              ],
              "0f6225ff-be31-4a60-b879-52c62f34a728": [
                "26ec6434-68a3-429e-9f61-4ce2cd4f44a1"
              ],
              "38084aeb-50bf-424d-b6f5-1b36e27dd38b": [
                "b875d467-481a-4074-adbd-80ecf1e6b1fa"
              ],
              "7b674c71-b784-45b8-a4cd-5b3032621b4a": [
                "2acb0d46-d1e7-46cb-bbec-4bb63732ffb8"
              ],
              "831a9582-46bf-4eb8-a26f-62f49b700033": [
                "5f76bd60-2add-4e38-ab64-b836eaa35ba6"
              ],
              "7bde3a49-84c9-48c5-a0f6-52c11b9b1bfa": [
                "28c06fa1-a2e6-42de-98c1-4a99764b74a2"
              ],
              "c78ceec3-02b5-4d41-b2c3-4b19654ea1a9": [
                "d51feec8-9b76-47e1-a1a3-db282489d8ee"
              ],
              "499d0df1-2c77-4d10-a1cf-4b3452bf997d": [
                "86934f75-3d47-4c92-8486-ace481b6f9a0"
              ],
              "a5f8c945-b155-44e5-98a9-94dfa6a3a184": [
                "cbd6efcb-4402-4486-ab75-85b28f42b01c"
              ],
              "af1248ea-05d5-4dac-ab71-b7adb9b70e91": [
                "960acbfe-de14-48ed-a34b-b5645d52a0c3"
              ],
              "456d96b4-f553-4dd4-8522-1ec737e7fee1": [
                "940db656-6811-48d7-97ec-bec0b6efa138"
              ]
            },
            "positions": {
              "af8f496f-7253-4fa5-b8da-1a960c313eb2": {
                "col": 7,
                "row": 8,
                "height": 3,
                "width": 6
              },
              "abd7426e-b772-42c6-a2c0-bfc8ba7e6af4": {
                "col": 1,
                "row": 3,
                "height": 2,
                "width": 3
              },
              "0f6225ff-be31-4a60-b879-52c62f34a728": {
                "col": 7,
                "row": 5,
                "height": 3,
                "width": 6
              },
              "38084aeb-50bf-424d-b6f5-1b36e27dd38b": {
                "col": 7,
                "row": 3,
                "height": 2,
                "width": 3
              },
              "7b674c71-b784-45b8-a4cd-5b3032621b4a": {
                "col": 1,
                "row": 5,
                "height": 3,
                "width": 6
              },
              "831a9582-46bf-4eb8-a26f-62f49b700033": {
                "col": 4,
                "row": 1,
                "height": 2,
                "width": 3
              },
              "7bde3a49-84c9-48c5-a0f6-52c11b9b1bfa": {
                "col": 7,
                "row": 1,
                "height": 2,
                "width": 3
              },
              "c78ceec3-02b5-4d41-b2c3-4b19654ea1a9": {
                "col": 10,
                "row": 1,
                "height": 4,
                "width": 3
              },
              "499d0df1-2c77-4d10-a1cf-4b3452bf997d": {
                "col": 1,
                "row": 8,
                "height": 3,
                "width": 6
              },
              "a5f8c945-b155-44e5-98a9-94dfa6a3a184": {
                "col": 1,
                "row": 11,
                "height": 4,
                "width": "Infinity"
              },
              "af1248ea-05d5-4dac-ab71-b7adb9b70e91": {
                "col": 1,
                "row": 1,
                "height": 2,
                "width": 3
              },
              "456d96b4-f553-4dd4-8522-1ec737e7fee1": {
                "col": 4,
                "row": 3,
                "height": 2,
                "width": 3
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "Graylog Professionals",
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP"
        },
        "type": "DASHBOARD",
        "description": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "0172b027-ecc4-4ccf-a822-088be0aec4eb",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-destination-ips"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-destination-ips"
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-destination-ips"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "dnslookup"
          },
          "lookup_type": {
            "@type": "string",
            "@value": "A"
          },
          "server_ips": {
            "@type": "string",
            "@value": ""
          },
          "request_timeout": {
            "@type": "integer",
            "@value": 3000
          },
          "cache_ttl_override_enabled": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "b3b88394-2dd5-4824-a58a-c479f9022b61",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "mongodb"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "1b2705ad-ffbe-4283-831a-6e37d16db554",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-source-hostnames"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-source-hostnames"
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-source-hostnames"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "dnslookup"
          },
          "lookup_type": {
            "@type": "string",
            "@value": "PTR"
          },
          "server_ips": {
            "@type": "string",
            "@value": ""
          },
          "request_timeout": {
            "@type": "integer",
            "@value": 3000
          },
          "cache_ttl_override_enabled": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "f0d28e7d-e12b-42fe-830c-60d38e1f89d2",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: windows-administrator-list"
        },
        "title": {
          "@type": "string",
          "@value": "Community: windows-administrator-list"
        },
        "description": {
          "@type": "string",
          "@value": "Community: windows-administrator-list"
        },
        "configuration": {
          "value_column": {
            "@type": "integer",
            "@value": 1
          },
          "separator": {
            "@type": "string",
            "@value": ","
          },
          "ignorechar": {
            "@type": "string",
            "@value": "#"
          },
          "refresh_interval": {
            "@type": "long",
            "@value": 60
          },
          "url": {
            "@type": "string",
            "@value": "http://lookuptables/windows-administrator-list.csv"
          },
          "quotechar": {
            "@type": "string",
            "@value": "\""
          },
          "key_column": {
            "@type": "integer",
            "@value": 0
          },
          "case_insensitive_lookup": {
            "@type": "boolean",
            "@value": true
          },
          "check_presence_only": {
            "@type": "boolean",
            "@value": true
          },
          "line_separator": {
            "@type": "string",
            "@value": "\\n"
          },
          "type": {
            "@type": "string",
            "@value": "dsvhttp"
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "fa4b706e-709f-4798-bbcf-7ccf708074b1",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-login-timestamps"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-login-timestamps"
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-login-timestamps"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "mongodb"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "1b8f11ad-bf66-4ceb-9de3-29e4774f5c29",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: windows-excluded-userdomains"
        },
        "title": {
          "@type": "string",
          "@value": "Community: windows-excluded-userdomains"
        },
        "description": {
          "@type": "string",
          "@value": "Community: windows-excluded-userdomains"
        },
        "configuration": {
          "value_column": {
            "@type": "integer",
            "@value": 1
          },
          "separator": {
            "@type": "string",
            "@value": ","
          },
          "ignorechar": {
            "@type": "string",
            "@value": "#"
          },
          "refresh_interval": {
            "@type": "long",
            "@value": 60
          },
          "url": {
            "@type": "string",
            "@value": "http://lookuptables/windows-excluded-userdomains.csv"
          },
          "quotechar": {
            "@type": "string",
            "@value": "\""
          },
          "key_column": {
            "@type": "integer",
            "@value": 0
          },
          "case_insensitive_lookup": {
            "@type": "boolean",
            "@value": true
          },
          "check_presence_only": {
            "@type": "boolean",
            "@value": true
          },
          "line_separator": {
            "@type": "string",
            "@value": "\\n"
          },
          "type": {
            "@type": "string",
            "@value": "dsvhttp"
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "2a9cbfc0-a73c-4b2a-b234-fa67ae0e5841",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: windows-service-accounts"
        },
        "title": {
          "@type": "string",
          "@value": "Community: windows-service-accounts"
        },
        "description": {
          "@type": "string",
          "@value": "Community: windows-service-accounts"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "mongodb"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "290cf273-d1a6-4f47-98a1-7951760ee0ce",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: windows-privileged-accounts"
        },
        "title": {
          "@type": "string",
          "@value": "Community: windows-privileged-accounts"
        },
        "description": {
          "@type": "string",
          "@value": "Community: windows-privileged-accounts"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "mongodb"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "c66488cf-08b8-44f4-a01f-19a2b4795d55",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "mongodb"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "6e42cf40-cdc5-4c7a-9c29-d79fe9b8226f",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "none"
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "995e5cbf-d044-443f-82cf-4bc2f4d4cfe0",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: windows-excluded-userdomains"
        },
        "title": {
          "@type": "string",
          "@value": "Community: windows-excluded-userdomains"
        },
        "description": {
          "@type": "string",
          "@value": "Community: windows-excluded-userdomains"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "guava_cache"
          },
          "max_size": {
            "@type": "integer",
            "@value": 100
          },
          "expire_after_access": {
            "@type": "long",
            "@value": 0
          },
          "expire_after_access_unit": {
            "@type": "string",
            "@value": "SECONDS"
          },
          "expire_after_write": {
            "@type": "long",
            "@value": 7
          },
          "expire_after_write_unit": {
            "@type": "string",
            "@value": "DAYS"
          },
          "ignore_null": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "878db63d-6500-437c-846e-8d8435b30cbb",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-source-hostnames"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-source-hostnames"
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-source-hostnames"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "guava_cache"
          },
          "max_size": {
            "@type": "integer",
            "@value": 10000
          },
          "expire_after_access": {
            "@type": "long",
            "@value": 5
          },
          "expire_after_access_unit": {
            "@type": "string",
            "@value": "MINUTES"
          },
          "expire_after_write": {
            "@type": "long",
            "@value": 0
          },
          "ignore_null": {
            "@type": "boolean",
            "@value": true
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "876ec82c-73ee-4674-9f16-c1af1e06c319",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: windows-privileged-accounts"
        },
        "title": {
          "@type": "string",
          "@value": "Community: windows-privileged-accounts"
        },
        "description": {
          "@type": "string",
          "@value": "Community: windows-privileged-accounts"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "guava_cache"
          },
          "max_size": {
            "@type": "integer",
            "@value": 1000
          },
          "expire_after_access": {
            "@type": "long",
            "@value": 0
          },
          "expire_after_access_unit": {
            "@type": "string",
            "@value": "HOURS"
          },
          "expire_after_write": {
            "@type": "long",
            "@value": 24
          },
          "expire_after_write_unit": {
            "@type": "string",
            "@value": "HOURS"
          },
          "ignore_null": {
            "@type": "boolean",
            "@value": true
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "719ea26e-b12a-4587-bf00-f32cae86ebf7",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-login-timestamps"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-login-timestamps"
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-login-timestamps"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "none"
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "0dc9b4cd-54e0-47e1-925d-6531a3ed9992",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: windows-service-accounts"
        },
        "title": {
          "@type": "string",
          "@value": "Community: windows-service-accounts"
        },
        "description": {
          "@type": "string",
          "@value": "Community: windows-service-accounts"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "guava_cache"
          },
          "max_size": {
            "@type": "integer",
            "@value": 1000
          },
          "expire_after_access": {
            "@type": "long",
            "@value": 0
          },
          "expire_after_access_unit": {
            "@type": "string",
            "@value": "SECONDS"
          },
          "expire_after_write": {
            "@type": "long",
            "@value": 24
          },
          "expire_after_write_unit": {
            "@type": "string",
            "@value": "HOURS"
          },
          "ignore_null": {
            "@type": "boolean",
            "@value": true
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "ecb0b027-1d31-4a17-82e2-99c5cb38d9f1",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-destination-ips"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-destination-ips"
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-destination-ips"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "guava_cache"
          },
          "max_size": {
            "@type": "integer",
            "@value": 10000
          },
          "expire_after_access": {
            "@type": "long",
            "@value": 5
          },
          "expire_after_access_unit": {
            "@type": "string",
            "@value": "MINUTES"
          },
          "expire_after_write": {
            "@type": "long",
            "@value": 0
          },
          "ignore_null": {
            "@type": "boolean",
            "@value": true
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "c51388cc-02ed-476c-983f-190b3f31819f",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: windows-administrator-list"
        },
        "title": {
          "@type": "string",
          "@value": "Community: windows-administrator-list"
        },
        "description": {
          "@type": "string",
          "@value": "Community: windows-administrator-list"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "guava_cache"
          },
          "max_size": {
            "@type": "integer",
            "@value": 100
          },
          "expire_after_access": {
            "@type": "long",
            "@value": 1
          },
          "expire_after_access_unit": {
            "@type": "string",
            "@value": "HOURS"
          },
          "expire_after_write": {
            "@type": "long",
            "@value": 0
          },
          "ignore_null": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "5bb4194e-d0c0-4a2a-b39e-079e0076ae05",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "none"
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "666a9dac-1dbb-49e0-bf89-64d0d8659cb0",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "876ec82c-73ee-4674-9f16-c1af1e06c319"
        },
        "name": {
          "@type": "string",
          "@value": "Community: windows-privileged-accounts"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "290cf273-d1a6-4f47-98a1-7951760ee0ce"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Community: windows-privileged-accounts"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Community: windows-privileged-accounts"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "f6d94b39-2c9b-4906-a71b-f2dcea504160",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "878db63d-6500-437c-846e-8d8435b30cbb"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-source-hostnames"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "1b2705ad-ffbe-4283-831a-6e37d16db554"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-source-hostnames"
        },
        "default_single_value": {
          "@type": "string",
          "@value": "\"Reverse DNS resolution for this IP not available\" "
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-source-hostnames"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "46c7d5cb-0cea-4d57-ae97-87ef379249fa",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "0dc9b4cd-54e0-47e1-925d-6531a3ed9992"
        },
        "name": {
          "@type": "string",
          "@value": "Community: windows-service-accounts"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "2a9cbfc0-a73c-4b2a-b234-fa67ae0e5841"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Community: windows-service-accounts"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Community: windows-service-accounts"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "f39d1849-e90f-45ab-8eb9-fcc02b054af8",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "ecb0b027-1d31-4a17-82e2-99c5cb38d9f1"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-destination-ips"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "0172b027-ecc4-4ccf-a822-088be0aec4eb"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-destination-ips"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-destination-ips"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "859c3208-dd0e-4085-89d3-fc706e95bf2f",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "719ea26e-b12a-4587-bf00-f32cae86ebf7"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-login-timestamps"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "fa4b706e-709f-4798-bbcf-7ccf708074b1"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-login-timestamps"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-login-timestamps"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "2a55abbf-27fb-4370-b1b2-21b4aefe03af",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "c51388cc-02ed-476c-983f-190b3f31819f"
        },
        "name": {
          "@type": "string",
          "@value": "Community: windows-administrator-list"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "f0d28e7d-e12b-42fe-830c-60d38e1f89d2"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Community: windows-administrator-list"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Community: windows-administrator-list"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "6a6fa0bb-b5d7-4296-bf19-3a38e7b9327c",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "995e5cbf-d044-443f-82cf-4bc2f4d4cfe0"
        },
        "name": {
          "@type": "string",
          "@value": "Community: windows-excluded-userdomains"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "1b8f11ad-bf66-4ceb-9de3-29e4774f5c29"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Community: windows-excluded-userdomains"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Community: windows-excluded-userdomains"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "e23a2b05-27ba-4c4d-8613-dc3a0420dd39",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "6e42cf40-cdc5-4c7a-9c29-d79fe9b8226f"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "b3b88394-2dd5-4824-a58a-c479f9022b61"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "6d163420-6191-489e-aa33-92f613cca681",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "5bb4194e-d0c0-4a2a-b39e-079e0076ae05"
        },
        "name": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "c66488cf-08b8-44f4-a01f-19a2b4795d55"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Community: rdp-logins"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "53ea60bb-2682-43fa-a24a-e8c1a91f692d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - Accounts"
        },
        "description": {
          "@type": "string",
          "@value": "Community: Windows Addons - Accounts"
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Community: Windows Addons - Accounts\"\nstage 121 match pass\nrule \"Community: Windows Addons - Accounts - 121\"\nstage 123 match either\nrule \"Community: Windows Addons - Accounts - 123\"\nrule \"Community: Windows Addons - Accounts - 125\"\nstage 124 match either\nrule \"Community: Windows Addons - Accounts - 124\"\nrule \"Community: Windows Addons - Accounts - 126\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "3c2f5895-a1eb-4301-9d41-e19f5a916cac"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "817d31fc-ff54-4f0d-a714-8677a25eae77",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP"
        },
        "description": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP"
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Community: Windows Addons - RDP\"\nstage 31 match pass\nrule \"Community: Windows Addons - RDP - 031\"\nstage 40 match pass\nrule \"Community: Windows Addons - RDP - 040 - N\"\nrule \"Community: Windows Addons - RDP - 040 - W\"\nrule \"Community: Windows Addons - RDP - 041 - N\"\nrule \"Community: Windows Addons - RDP - 041 - W\"\nrule \"Community: Windows Addons - RDP - 042 - N\"\nrule \"Community: Windows Addons - RDP - 042 - W\"\nrule \"Community: Windows Addons - RDP - 044 - N\"\nrule \"Community: Windows Addons - RDP - 044 - W\"\nstage 61 match pass\nrule \"Community: Windows Addons - RDP - 061\"\nstage 62 match pass\nrule \"Community: Windows Addons - RDP - 062\"\nstage 64 match pass\nrule \"Community: Windows Addons - RDP - 065\"\nrule \"Community: Windows Addons - RDP - 066\"\nstage 110 match pass\nrule \"Community: Windows Addons - RDP - 111\"\nstage 120 match pass\nrule \"Community: Windows Addons - RDP - 121\"\nstage 130 match pass\nrule \"Community: Windows Addons - RDP - 131\"\nstage 200 match pass\nrule \"Community: Windows Addons - RDP - 202\"\nrule \"Community: Windows Addons - RDP - 203\"\nstage 211 match pass\nrule \"Community: Windows Addons - RDP - 211\"\nstage 212 match pass\nrule \"Community: Windows Addons - RDP - 212\"\nstage 220 match either\nrule \"Community: Windows Addons - RDP - 221\"\nrule \"Community: Windows Addons - RDP - 222\"\nrule \"Community: Windows Addons - RDP - 224\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "3c2f5895-a1eb-4301-9d41-e19f5a916cac"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "f2641502-af23-4599-8048-f0c68fbeba8a",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 041 - N"
        },
        "description": {
          "@type": "string",
          "@value": "Add \"windows_elevated_token\" to \"No\" on messages containing field \"ElevatedToken\" equals \"%%1843\" - NXLOG"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 041 - N\"\n\nwhen\n    to_string($message.ElevatedToken) == \"%%1843\"\n    \nthen\n    set_field(\"windows_elevated_token\", \"No\");\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "ad398c76-6326-498f-ac9e-0a2437cd205a",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 062"
        },
        "description": {
          "@type": "string",
          "@value": "Add \"gim_tags\" on Logs with \"windows_session_name\" equals \"windows_rdp\""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 062\"\n\nwhen\n    to_string($message.windows_session_name) == \"windows_rdp\" \n\nthen\n    set_field(\"gim_tags\", string_array_add(to_list($message.gim_tags), \"remote_access\", true));\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "3a29ead3-926d-4ae3-89dc-1fda4a0e07bc",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 066"
        },
        "description": {
          "@type": "string",
          "@value": "Add \"source_ip\" based on DNS lookup"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 066\"\n\nwhen\n    has_field(\"destination_hostname\")\n    && has_field(\"destination_ip\") == false\n    && array_contains(to_list($message.gim_tags), \"remote_access\") \n    \nthen\n    let destinationip = lookup_value(\n            lookup_table: \"Community: rdp-destination-ips\", \n            key: to_string($message.destination_hostname)\n            );\n    \n    set_field(\"destination_ip\", to_ip(destinationip));\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "5584d717-f0cf-4c4e-b61c-2d3da0730f7b",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 044 - W"
        },
        "description": {
          "@type": "string",
          "@value": "Add \"windows_session_name\" on messages containing field \"winlogbeat_winlog_event_data_SessionName\" - WINLOGBEAT"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 044 - W\"\n\nwhen\n    NOT has_field(\"windows_logon_type\")\n    AND has_field(\"winlogbeat_winlog_event_data_SessionName\")\n    \nthen\n    let field = regex_replace(\n        value: to_string($message.winlogbeat_winlog_event_data_SessionName), \n        pattern: \"RDP-Tcp\\\\#\\\\d+\",\n        replacement: \"windows_rdp\"\n        );\n    \n    set_field(\"windows_session_name\", field);\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "f450a184-a814-4c3a-b773-89eca690f82e",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - Accounts - 124"
        },
        "description": {
          "@type": "string",
          "@value": "Enriching Authentication Logs with windows_account_tag \"privileged\""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - Accounts - 124\"\nwhen \n    has_field(\"user_id\")\n    && lookup_has_value(\"Community: windows-privileged-accounts\", to_string($message.user_id)) == true\n\nthen\n    set_field(\"windows_account_tags\", string_array_add($message.windows_account_tags, \"privileged\", true));\n\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "43ef075c-7b22-464f-ba13-50d365ed7169",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 040 - N"
        },
        "description": {
          "@type": "string",
          "@value": "Add \"windows_elevated_token\" to \"Yes\" on messages containing field \"ElevatedToken\" equals \"%%1842\" - NXLOG"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 040 - N\"\n\nwhen\n    to_string($message.ElevatedToken) == \"%%1842\"\n    \nthen\n    set_field(\"windows_elevated_token\", \"Yes\");\n    \n    // debug\n    // set_field(\"Pipeline\", \"Community: Windows Addons - RDP - 040\");\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "1f75b3b4-115c-40fa-a8bd-5af03f13ad51",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 040 - W"
        },
        "description": {
          "@type": "string",
          "@value": "Add \"windows_elevated_token\" to \"Yes\" on messages containing field \"winlogbeat_winlog_event_data_ElevatedToken\" equals \"%%1842\" - WINLOGBEAT"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 040 - W\"\n\nwhen\n    to_string($message.winlogbeat_winlog_event_data_ElevatedToken) == \"%%1842\"\n    \nthen\n    set_field(\"windows_elevated_token\", \"Yes\");\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "c52a8096-2f2e-4e13-a147-4e7c24b5a4ba",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - Accounts - 126"
        },
        "description": {
          "@type": "string",
          "@value": "Enriching Authentication Logs with windows_account_tag \"service\""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - Accounts - 126\"\nwhen \n    has_field(\"user_id\")\n    && lookup_has_value(\"Community: windows-service-accounts\", to_string($message.user_id)) == true\n\nthen\n    set_field(\"windows_account_tags\", string_array_add($message.windows_account_tags, \"service\", true));\n\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "052b6cf4-0c87-4d0f-99bb-ab2ce4299421",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 121"
        },
        "description": {
          "@type": "string",
          "@value": "Removing disconnected Sessions from Active Sessions Table"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 121\"\nwhen\n    has_field(\"gim_event_type\")\n    && has_field(\"user_session_id\")\n    && array_contains($message.gim_event_type,\"session disconnect\")\n    && to_string($message.event_outcome) == \"success\"\n    && lookup_has_value(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let rdp_user_collection = lookup_remove_string_list(\n        lookup_table: \"Community: rdp-logins\",\n        key: \"rdp_as\", \n        value: [to_string($message.user_session_id)]\n    );\n    \n    let rdp_session_status = lookup_add_string_list(\n        lookup_table: \"Community: rdp-logins\",\n        key: \"rdp_is\", \n        value: [to_string($message.user_session_id)]\n    );\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "b6897e0c-1a97-4d10-bfd3-cfc3042b3938",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 212"
        },
        "description": {
          "@type": "string",
          "@value": "Remove Session durations shorter than a Second"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 212\"\n\nwhen\n    has_field(\"user_session_duration\")\n    && to_long($message.user_session_duration) < 1000\n    \nthen\n    remove_single_field(\"user_session_duration\");\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "b3180d87-3047-422d-a81d-e95fbeb4bb3d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - Accounts - 123"
        },
        "description": {
          "@type": "string",
          "@value": "Collecting user_id from privileged login to \"windows-privileged-accounts\""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - Accounts - 123\"\nwhen\n    lookup_value(\"Community: windows-excluded-userdomains\", to_string($message.user_domain)) == false\n    && lookup_has_value(\"Community: windows-privileged-accounts\", to_string($message.user_id)) == false\n    && array_contains(to_list($message.privilege_category), \"elevated_privilege\", true)\n    && to_string($message.event_outcome) == \"success\"\n    && regex(\"[A-Za-z0-9\\\\_\\\\-\\\\.]+?\\\\$\", to_string($message.user_name)).matches == false\n\nthen\n    lookup_set_value(\n        lookup_table: \"Community: windows-privileged-accounts\",\n        key: to_string($message.user_id),\n        value: to_string($message.user_name), \n        ttl: 86400\n    );\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "e13e84ad-3a31-497a-9f4e-ef9faf42d49b",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - Accounts - 125"
        },
        "description": {
          "@type": "string",
          "@value": "Collecting user_id from service login to \"windows-service-accounts\""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - Accounts - 125\"\nwhen\n    \n    lookup_value(\"Community: windows-excluded-userdomains\", to_string($message.user_domain)) == false\n    && lookup_has_value(\"Community: windows-service-accounts\", to_string($message.user_id)) == false\n    && to_long($message.windows_logon_type) == 5\n    && to_string($message.event_outcome) == \"success\"\n\nthen\n    lookup_set_value(\n        lookup_table: \"Community: windows-service-accounts\",\n        key: to_string($message.user_id),\n        value: to_string($message.user_name), \n        ttl: 86400\n    );\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "edb3e9d9-a4cf-4e75-b24b-9e556da91b24",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 131"
        },
        "description": {
          "@type": "string",
          "@value": "Removing disconnected Sessions from Inactive Sessions Table"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 131\"\nwhen\n    has_field(\"gim_event_type\")\n    && has_field(\"user_session_id\")\n    && array_contains($message.gim_event_type,\"session reconnect\")\n    && to_string($message.event_outcome) == \"success\"\n    && lookup_has_value(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let rdp_user_collection = lookup_remove_string_list(\n        lookup_table: \"Community: rdp-logins\",\n        key: \"rdp_is\", \n        value: [to_string($message.user_session_id)]\n    );\n    \n    let rdp_session_status = lookup_add_string_list(\n        lookup_table: \"Community: rdp-logins\",\n        key: \"rdp_as\", \n        value: [to_string($message.user_session_id)]\n    );\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "75140dbd-a89c-45f0-a585-e7f59954d823",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 042 - N"
        },
        "description": {
          "@type": "string",
          "@value": "Add \"windows_logon_type\" on messages containing field \"LogonType\" - NXLOG"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 042 - N\"\n\nwhen\n    has_field(\"LogonType\")\n    \nthen\n    set_field(\"windows_logon_type\", to_long($message.LogonType));\n    set_field(\"windows_logon_type_description\", \"RemoteInteractive Logon\");\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "87d86a1e-7605-4684-928d-391dfb7cacdf",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 044 - N"
        },
        "description": {
          "@type": "string",
          "@value": "Add \"windows_session_name\" on messages containing field \"SessionName\"  - NXLOG"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 044 - N\"\n\nwhen\n    NOT has_field(\"windows_logon_type\")\n    AND has_field(\"SessionName\")\n    \nthen\n    let field = regex_replace(\n        value: to_string($message.SessionName), \n        pattern: \"RDP-Tcp\\\\#\\\\d+\",\n        replacement: \"windows_rdp\"\n        );\n    \n    set_field(\"windows_session_name\", field);\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "c401d440-52c2-4582-8d8a-ee424ec17f7c",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 203"
        },
        "description": {
          "@type": "string",
          "@value": "Enrich Logoff Messages with source_ip, destination_ip and source_hostname"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 203\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && has_field(\"user_session_id\")\n    && array_contains($message.gim_event_type,\"logoff\")\n    && to_string($message.event_outcome) == \"success\" \n    && lookup_has_value(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let source_ip = list_get(lookup_string_list(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ),1);\n    \n    let source_hostname = list_get(lookup_string_list(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ),2);\n    \n    let destination_ip = list_get(lookup_string_list(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ),3);\n    \n    let windows_elevated_token = list_get(lookup_string_list(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ),4);\n    \n    set_field(\"source_ip\", source_ip);\n    set_field(\"source_hostname\", source_hostname);\n    set_field(\"destination_ip\", destination_ip);\n    set_field(\"windows_elevated_token\", windows_elevated_token);\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "68882184-7d91-4803-a097-f247100951e1",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 111"
        },
        "description": {
          "@type": "string",
          "@value": "Collecting RDP Logins and writing them to MongoDB"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 111\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && has_field(\"gim_tags\")\n    && has_field(\"user_session_id\")\n    && array_contains($message.gim_tags,\"remote_access\")\n    && array_contains($message.gim_event_type,\"logon\")\n    && to_string($message.event_outcome) == \"success\"\n    && to_string($message.windows_elevated_token) == \"No\"\n\nthen\n    lookup_add_string_list(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id),\n        value: [to_string($message.timestamp),\n                to_string($message.source_ip),\n                to_string($message.source_hostname),\n                to_string($message.destination_ip),\n                to_string($message.windows_elevated_token)]\n        );\n    \n    lookup_add_string_list(\n        lookup_table: \"Community: rdp-logins\",\n        key: \"rdp_as\", \n        value: [to_string($message.user_session_id)]\n    );\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "5c2127f8-8218-4417-b68f-9d6d55925ec3",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 211"
        },
        "description": {
          "@type": "string",
          "@value": "Calculating Session Duration based on Logoff Time and adding the result in Fields"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 211\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && has_field(\"user_session_id\")\n    && array_contains($message.gim_event_type,\"logoff\")\n    && to_string($message.event_outcome) == \"success\" \n    && lookup_has_value(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let session_login_time = list_get(lookup_string_list(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ),0);\n    \n    let login_time = to_long(parse_date(\n        value: to_string(session_login_time),\n        pattern: \"yyyy-MM-dd'T'HH:mm:ss.SSSZ\",\n        locale: \"de_DE\").millis);\n    \n    let current_time = to_long(parse_date(\n        value: to_string($message.timestamp),\n        pattern: \"yyyy-MM-dd'T'HH:mm:ss.SSSZ\",\n        locale: \"de_DE\").millis);\n    \n    let session_duration = current_time - login_time;\n    \n    set_field(\"user_session_duration\", session_duration);\n    set_field(\"user_session_duration_seconds\", session_duration/1000);\n    set_field(\"user_session_duration_minutes\", session_duration/1000/60);\n    set_field(\"user_session_duration_hours\", session_duration/1000/60/60); \n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "a968d429-2852-4a62-a322-906e89ab5bca",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 065"
        },
        "description": {
          "@type": "string",
          "@value": "Add \"source_hostname\" based on DNS reverse lookup"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 065\"\n\nwhen\n    has_field(\"source_ip\")\n    && array_contains(to_list($message.gim_tags), \"remote_access\") \n    \nthen\n    let sourcehostname = regex_replace(\n            value: to_string(lookup_value(\"Community: rdp-source-hostnames\", to_string($message.source_ip))), \n            pattern: \"(^.*)\\\\.\", \n            replacement: \"$1\"\n            );\n    \n    set_field(\"source_hostname\", sourcehostname);\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "33959f20-cc3f-495a-aba6-513be9486597",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 202"
        },
        "description": {
          "@type": "string",
          "@value": "Determining whether a logoff is related to a Remote Session and setting values accordingly"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 202\"\nwhen\n    has_field(\"gim_event_type\")\n    && array_contains($message.gim_event_type,\"logoff\") \n    && to_string($message.event_outcome) == \"success\"  \n    && lookup_has_value(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    set_field(\"application_name\",\"windows_rdp\"); \n    set_field(\"windows_logon_type\", 10);\n    set_field(\"windows_logon_type_description\", \"RemoteInteractive Logon\");\n    set_field(\"gim_tags\", string_array_add(to_list($message.gim_tags), \"remote_access\"));\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "60555f75-5b6c-4609-a6a2-4d68a3d65ae6",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 224"
        },
        "description": {
          "@type": "string",
          "@value": "Remove \"user_session_id\" from inactive RDP sessions Lookup Table  (Hygiene)"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 224\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && array_contains($message.gim_event_type,\"logoff\") \n    && to_string($message.event_outcome) == \"success\"  \n    && lookup_string_list_contains(\n        lookup_table: \"Community: rdp-logins\",\n        key: \"rdp_is\",\n        value: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let rdp_user_collection = lookup_remove_string_list(\n        lookup_table: \"Community: rdp-logins\",\n        key: \"rdp_is\", \n        value: [to_string($message.user_session_id)]\n    );\n\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "43bb411a-0af6-4545-9669-fef1783b0487",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 222"
        },
        "description": {
          "@type": "string",
          "@value": "Remove \"user_session_id\" from active RDP sessions Lookup Table"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 222\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && array_contains($message.gim_event_type,\"logoff\") \n    && to_string($message.event_outcome) == \"success\"  \n    && lookup_string_list_contains(\n        lookup_table: \"Community: rdp-logins\",\n        key: \"rdp_as\",\n        value: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let rdp_user_collection = lookup_remove_string_list(\n        lookup_table: \"Community: rdp-logins\",\n        key: \"rdp_as\", \n        value: [to_string($message.user_session_id)]\n    );\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "534b7254-12fd-4b51-bef8-b958cd0a37e7",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 221"
        },
        "description": {
          "@type": "string",
          "@value": "Collecting RDP Logoffs and removing them from MongoDB"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 221\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && array_contains($message.gim_event_type,\"logoff\") \n    && to_string($message.event_outcome) == \"success\"  \n    && lookup_has_value(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let result = list_get(lookup_string_list(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ),0);\n    \n    lookup_clear_key(\n        lookup_table: \"Community: rdp-login-timestamps\",\n        key: to_string($message.user_session_id)\n    );\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "86446061-6247-47d4-80f7-de43a783dd92",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 042 - W"
        },
        "description": {
          "@type": "string",
          "@value": "Add \"windows_logon_type\" on messages containing field \"winlogbeat_winlog_event_data_LogonType\" - WINLOGBEAT"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 042 - W\"\n\nwhen\n    has_field(\"winlogbeat_winlog_event_data_LogonType\")\n    \nthen\n    set_field(\"windows_logon_type\", to_long($message.winlogbeat_winlog_event_data_LogonType));\n    set_field(\"windows_logon_type_description\", \"RemoteInteractive Logon\");\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "861cfbf7-fb29-405f-b771-0f08cf7e6ee7",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 031"
        },
        "description": {
          "@type": "string",
          "@value": "Filter Logs with \"gim_event_category\" equals \"authentication\" and add field \"destination_hostname\""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 031\"\n\nwhen\n    array_contains(to_list($message.gim_event_subcategory), \"authentication.logon\")\n    || array_contains(to_list($message.gim_event_subcategory), \"authentication.logoff\")\n    \nthen\n    set_field(\"destination_hostname\", to_string($message.event_source));\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "8dec603f-3587-4ede-81cc-c0074bd4cb68",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - Accounts - 121"
        },
        "description": {
          "@type": "string",
          "@value": "Add Tag \"legitimate_admin\" to all logs containing a user_name from the windows_administrator list"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - Accounts - 121\"\nwhen\n    (array_contains(to_list($message.gim_event_subcategory),\"authentication.logon\") \n    || array_contains(to_string($message.gim_event_subcategory), \"authentication.logoff\"))\n    &&lookup_value(\"Community: windows-administrator-list\", to_string($message.user_name)) == true\n\nthen\n    set_field(\"windows_account_tags\", string_array_add(to_list($message.user_account_tags), \"legitimate_admin\"));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "50512a44-b5fd-40d0-8d32-22780f1e2da8",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 041 - W"
        },
        "description": {
          "@type": "string",
          "@value": "Add \"windows_elevated_token\" to \"No\" on messages containing field \"winlogbeat_winlog_event_data_ElevatedToken\" equals \"%%1843\" - WINLOGBEAT"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 041 - W\"\n\nwhen\n    to_string($message.winlogbeat_winlog_event_data_ElevatedToken) == \"%%1843\"\n    \nthen\n    set_field(\"windows_elevated_token\", \"No\");\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "a338ef9c-750e-4c3a-bfca-373c34f64b9f",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Community: Windows Addons - RDP - 061"
        },
        "description": {
          "@type": "string",
          "@value": "Add \"application_name\" on Logs with \"windows_logon_type\" equals \"10\""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Community: Windows Addons - RDP - 061\"\n\nwhen\n    to_long($message.windows_logon_type) == 10\n    \nthen\n    set_field(\"application_name\", \"windows_rdp\");\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream_title",
        "version": "1"
      },
      "id": "ac71d79c-624e-4f67-8f94-4166f041f68a",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Illuminate:Windows Security Event Log Messages"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream_title",
        "version": "1"
      },
      "id": "000000000000000000000002",
      "data": {
        "title": {
          "@type": "string",
          "@value": "All events"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream_title",
        "version": "1"
      },
      "id": "000000000000000000000003",
      "data": {
        "title": {
          "@type": "string",
          "@value": "All system events"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=7.0.4+ac94792"
        }
      ]
    }
  ]
}