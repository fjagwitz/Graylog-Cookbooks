{
  "v": "1",
  "id": "f2293921-2945-4fb8-8ea2-d295a23167d1",
  "rev": 5,
  "name": "Graylog Professionals: Windows - RDP Monitoring",
  "summary": "Graylog Professionals: Windows - RDP Monitoring",
  "description": "Graylog Professionals: Windows - RDP Monitoring",
  "vendor": "Graylog Community",
  "url": "https://github.com/fjagwitz/Graylog-Cookbooks/tree/main/05_Use%20Cases/Windows/Monitor%20Remote%20Desktop%20Connections",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "dashboard",
        "version": "2"
      },
      "id": "aefccfbf-221c-4634-a5f6-3f114d93a3b5",
      "data": {
        "summary": {
          "@type": "string",
          "@value": "Graylog Professionals: Windows - RDP Monitoring"
        },
        "search": {
          "queries": [
            {
              "id": "67b924dc-d190-4163-8a37-b77bda3e7362",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:session_duration_minutes AND NOT user_sid_rid:500"
                  },
                  "name": "chart",
                  "timerange": {
                    "range": 0,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "sum",
                      "id": "Overall Session Duration (mins)",
                      "field": "session_duration_minutes"
                    },
                    {
                      "type": "avg",
                      "id": "Avg Session Duration (mins)",
                      "field": "session_duration_minutes",
                      "whole_number": false
                    },
                    {
                      "type": "count",
                      "id": "Number of Sessions",
                      "field": "user_session_id"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "user_name",
                        "event_source"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "bd15118f-2b90-43c4-a458-013b9b3e0bfc",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "series",
                      "field": "count(user_session_id)",
                      "direction": "Descending"
                    }
                  ]
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:session_duration_minutes AND NOT user_sid_rid:500"
                  },
                  "name": "chart",
                  "timerange": {
                    "range": 0,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "sum",
                      "id": "Session Duration",
                      "field": "session_duration_minutes"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "user_name"
                      ],
                      "limit": 5,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "f4801c83-6721-4593-9463-8f2d0aa6b65d",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "series",
                      "field": "sum(session_duration_minutes)",
                      "direction": "Descending"
                    }
                  ]
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "user_session_id:$active_rdp_sessions$"
                  },
                  "name": "chart",
                  "timerange": {
                    "range": 0,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count(source_user_session_id)",
                      "field": "source_user_session_id"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "id": "940ec3a9-274a-4ad8-9b0b-906c1d4c31c5",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "user_session_id:$active_rdp_sessions$"
                  },
                  "name": "chart",
                  "timerange": {
                    "range": 0,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "user_name",
                        "event_source"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "12f00f15-99fe-4d0a-9548-0340161a5cb7",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                }
              ]
            }
          ],
          "parameters": [
            {
              "optional": false,
              "lookup_table": "windows-rdp-monitoring-active-logins",
              "name": "active_rdp_sessions",
              "data_type": "any",
              "default_value": "none",
              "title": "active_rdp_sessions",
              "type": "lut-parameter-v1",
              "description": "active_rdp_sessions",
              "key": "active_rdp_sessions"
            }
          ],
          "requires": {
            "parameters": {
              "name": "Graylog Enterprise",
              "author": "Graylog, Inc.",
              "url": "https://www.graylog.org/enterprise",
              "version": "3.1.0",
              "description": "Graylog Enterprise",
              "unique_id": "org.graylog.plugins.enterprise.EnterprisePlugin"
            }
          },
          "owner": "rfuchs",
          "created_at": "2024-06-14T17:44:16.618Z"
        },
        "created_at": "2024-06-14T17:25:26.453Z",
        "requires": {
          "parameters": {
            "name": "Graylog Enterprise",
            "author": "Graylog, Inc.",
            "url": "https://www.graylog.org/enterprise",
            "version": "3.1.0",
            "description": "Graylog Enterprise",
            "unique_id": "org.graylog.plugins.enterprise.EnterprisePlugin"
          }
        },
        "state": {
          "67b924dc-d190-4163-8a37-b77bda3e7362": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "RDP Session Overview"
              },
              "widget": {
                "undefined": "Messages for user_name:aarnel",
                "a4d97060-cc95-4131-b81c-2f072dca2900": "RDP Session Durations",
                "f8637d4b-34b9-470d-bbbc-ff28fdc03bf3": "Active RDP Sessions",
                "2f49c4b1-758f-468f-b943-da6ffab51d84": "Finished RDP Session Durations (detailed)",
                "fd4dd9f6-a69b-4180-a8a5-9739a1b8c844": "Active RDP Sessions (Users)"
              }
            },
            "widgets": [
              {
                "id": "f8637d4b-34b9-470d-bbbc-ff28fdc03bf3",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 0,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "user_session_id:$active_rdp_sessions$"
                },
                "streams": [],
                "config": {
                  "visualization": "numeric",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count(source_user_session_id)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": false,
                    "trend_preference": "NEUTRAL"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "fd4dd9f6-a69b-4180-a8a5-9739a1b8c844",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 0,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "user_session_id:$active_rdp_sessions$"
                },
                "streams": [],
                "config": {
                  "visualization": "table",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "user_name",
                        "event_source"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": []
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "2f49c4b1-758f-468f-b943-da6ffab51d84",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 0,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:session_duration_minutes AND NOT user_sid_rid:500"
                },
                "streams": [],
                "config": {
                  "visualization": "table",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "user_name",
                        "event_source"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15,
                        "skip_empty_values": false
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Overall Session Duration (mins)"
                      },
                      "function": "sum(session_duration_minutes)"
                    },
                    {
                      "config": {
                        "name": "Avg Session Duration (mins)"
                      },
                      "function": "avg(session_duration_minutes)"
                    },
                    {
                      "config": {
                        "name": "Number of Sessions"
                      },
                      "function": "count(user_session_id)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": []
                  },
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "series",
                      "field": "count(user_session_id)",
                      "direction": "Descending"
                    }
                  ]
                }
              },
              {
                "id": "a4d97060-cc95-4131-b81c-2f072dca2900",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "range": 0,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:session_duration_minutes AND NOT user_sid_rid:500"
                },
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 5,
                  "row_pivots": [
                    {
                      "fields": [
                        "user_name"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 5,
                        "skip_empty_values": false
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Session Duration"
                      },
                      "function": "sum(session_duration_minutes)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "barmode": "group",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "series",
                      "field": "sum(session_duration_minutes)",
                      "direction": "Descending"
                    }
                  ]
                }
              }
            ],
            "widget_mapping": {
              "f8637d4b-34b9-470d-bbbc-ff28fdc03bf3": [
                "940ec3a9-274a-4ad8-9b0b-906c1d4c31c5"
              ],
              "fd4dd9f6-a69b-4180-a8a5-9739a1b8c844": [
                "12f00f15-99fe-4d0a-9548-0340161a5cb7"
              ],
              "2f49c4b1-758f-468f-b943-da6ffab51d84": [
                "bd15118f-2b90-43c4-a458-013b9b3e0bfc"
              ],
              "a4d97060-cc95-4131-b81c-2f072dca2900": [
                "f4801c83-6721-4593-9463-8f2d0aa6b65d"
              ]
            },
            "positions": {
              "a4d97060-cc95-4131-b81c-2f072dca2900": {
                "col": 7,
                "row": 1,
                "height": 4,
                "width": 6
              },
              "f8637d4b-34b9-470d-bbbc-ff28fdc03bf3": {
                "col": 1,
                "row": 1,
                "height": 4,
                "width": 3
              },
              "2f49c4b1-758f-468f-b943-da6ffab51d84": {
                "col": 1,
                "row": 5,
                "height": 4,
                "width": "Infinity"
              },
              "fd4dd9f6-a69b-4180-a8a5-9739a1b8c844": {
                "col": 4,
                "row": 1,
                "height": 4,
                "width": 3
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "rfuchs",
        "title": {
          "@type": "string",
          "@value": "Graylog Professionals: Windows - RDP Monitoring"
        },
        "type": "DASHBOARD",
        "description": {
          "@type": "string",
          "@value": "Graylog Professionals: Windows - RDP Monitoring"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.0.2+c751f7c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "afcfa962-54b0-453d-8e7f-4186efee4c07",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-login-timestamps"
        },
        "title": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-login-timestamps"
        },
        "description": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-login-timestamps"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "mongodb"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.0.2+c751f7c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "a680010c-9a81-4bea-ab90-1f5cb398f662",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-active-logins"
        },
        "title": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-active-logins"
        },
        "description": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-active-logins"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "mongodb"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.0.2+c751f7c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "cb3e873e-6b01-4016-9dfd-f89db4becb5a",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-login-timestamps"
        },
        "title": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-login-timestamps"
        },
        "description": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-login-timestamps"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "none"
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.0.2+c751f7c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "2e9dca7e-bf72-456a-aaaa-3a9c1de89da8",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-active-logins"
        },
        "title": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-active-logins"
        },
        "description": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-active-logins"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "none"
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.0.2+c751f7c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "96b55181-255a-4162-bbe4-7fe2dbc1c490",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "2e9dca7e-bf72-456a-aaaa-3a9c1de89da8"
        },
        "name": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-active-logins"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "a680010c-9a81-4bea-ab90-1f5cb398f662"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-active-logins"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-active-logins"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.0.2+c751f7c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "cf7d57ca-d4e8-4bce-8c61-e319fb481ffc",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "cb3e873e-6b01-4016-9dfd-f89db4becb5a"
        },
        "name": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-login-timestamps"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "afcfa962-54b0-453d-8e7f-4186efee4c07"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-login-timestamps"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "windows-rdp-monitoring-login-timestamps"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.0.2+c751f7c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "399c77b3-d8d3-441e-ba78-f770a1b5b1af",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Professional: Windows - RDP Monitoring"
        },
        "description": {
          "@type": "string",
          "@value": "Professional: Windows - RDP Monitoring"
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Professional: Windows - RDP Monitoring\"\nstage 0 match either\nstage 11 match pass\nrule \"Professional: Windows - RDP Monitoring - 11\"\nstage 12 match either\nrule \"Professional: Windows - RDP Monitoring - 12\"\nstage 13 match either\nrule \"Professional: Windows - RDP Monitoring - 13\"\nend"
        },
        "connected_streams": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.0.2+c751f7c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "1ebfde8a-ac88-4381-bc77-5ed886cad267",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Professional: Windows - RDP Monitoring - 12"
        },
        "description": {
          "@type": "string",
          "@value": "Calculating Session Duration based on Logoff Time and adding the result in Fields"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Professional: Windows - RDP Monitoring - 12\"\n\nwhen\n\n    has_field(\"gim_event_type\")\n    && has_field(\"user_session_id\")\n    && array_contains($message.gim_event_type,\"logoff\")\n    && to_string($message.event_outcome) == \"success\" \n    && lookup_has_value(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let session_login_time = list_get(lookup_string_list(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ),0);\n    \n    let login_time = to_long(parse_date(\n        value: to_string(session_login_time),\n        pattern: \"yyyy-MM-dd'T'HH:mm:ss.SSSZ\",\n        locale: \"de_DE\").millis);\n        \n    let current_time = to_long(parse_date(\n        value: to_string(now(timezone:\"Europe/Berlin\")),\n        pattern: \"yyyy-MM-dd'T'HH:mm:ss.SSSZ\",\n        locale: \"de_DE\").millis);\n    \n    let session_duration = current_time - login_time;\n    \n    set_field(\"session_duration_milliseconds\", session_duration);\n    set_field(\"session_duration_seconds\", session_duration/1000);\n    set_field(\"session_duration_minutes\", session_duration/1000/60);\n    set_field(\"session_duration_hours\", session_duration/1000/60/60); \n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.0.2+c751f7c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "4684f9d7-b249-4a09-85a2-03e3bbc41154",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Professional: Windows - RDP Monitoring - 11"
        },
        "description": {
          "@type": "string",
          "@value": "Collecting RDP Logins and writing them to MongoDB"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Professional: Windows - RDP Monitoring - 11\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && array_contains($message.gim_event_type,\"logon\")\n    && to_string($message.event_outcome) == \"success\"\n    && to_string($message.application_name) == \"windows_rdp\"\n    && ( to_string($message.winlogbeat_winlog_event_data_ElevatedToken) == \"%%1843\"\n        || to_string($message.ElevatedToken) == \"%%1843\" )\n    \nthen\n    let rdp_user = lookup_set_value(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id),\n        value: to_string($message.timestamp)\n    );\n    \n    let rdp_user_collection = lookup_add_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions\", \n        value: [to_string($message.user_session_id)]\n    );\n\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.0.2+c751f7c"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "20e1a972-ee66-4103-8227-54697e0e7c19",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Professional: Windows - RDP Monitoring - 13"
        },
        "description": {
          "@type": "string",
          "@value": "Collecting RDP Logoffs and removing them from MongoDB\t"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Professional: Windows - RDP Monitoring - 13\"\n\nwhen\n    has_field(\"gim_event_type\")\n    && array_contains($message.gim_event_type,\"logoff\") \n    && to_string($message.event_outcome) == \"success\"  \n    && lookup_has_value(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id)\n    ) == true\n    \nthen\n    let rdp_user = lookup_clear_key(\n        lookup_table: \"windows-rdp-monitoring-login-timestamps\",\n        key: to_string($message.user_session_id)\n    );\n\n    let rdp_user_collection = lookup_remove_string_list(\n        lookup_table: \"windows-rdp-monitoring-active-logins\",\n        key: \"active_rdp_sessions\", \n        value: [to_string($message.user_session_id)]\n    );\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.0.2+c751f7c"
        }
      ]
    }
  ]
}