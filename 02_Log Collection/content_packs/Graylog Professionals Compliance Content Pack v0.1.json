{
  "v": 1,
  "id": "6b25315e-f745-4752-9c69-a8b741863157",
  "rev": 1,
  "name": "Graylog Professionals: Windows Compliance",
  "summary": "Graylog Professionals: Windows Compliance",
  "description": "Graylog Professionals: Windows Compliance",
  "vendor": "Windows Professionals",
  "url": "https://github.com/fjagwitz/Graylog-Cookbooks/tree/Graylog-6.3.3/02_Log%20Collection/content_packs",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "94174b61-fa4e-4e21-9511-6885c4ed4d7f",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Graylog Professionals: Windows - Compliance"
        },
        "description": {
          "@type": "string",
          "@value": "Graylog Professionals: Windows - Compliance"
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Graylog Professionals: Windows - Compliance\"\nstage 0 match either\nstage 1 match either\nrule \"graylog-professionals-windows-compliance-1\"\nstage 3 match either\nrule \"graylog-professionals-windows-compliance - 3a\"\nrule \"graylog-professionals-windows-compliance - 3b\"\nstage 4 match either\nrule \"graylog-professionals-windows-compliance - 4\"\nstage 5 match either\nrule \"graylog-professionals-windows-compliance - 5\"\nstage 2 match pass\nrule \"graylog-professionals-windows-compliance - 2\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "183d9976-07f4-4872-b253-08608d7f4a3a"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "81c77f00-38b1-44ac-828e-c34c0f918f0f",
      "data": {
        "title": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance-1"
        },
        "description": {
          "@type": "string",
          "@value": "Execute basic parsing"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"graylog-professionals-windows-compliance-1\"\nwhen\n    to_string($message.nxlog_tag) == \"Compliance_WindowsServerRoles\"\n    \nthen\n    let compliance_fields = flatten_json(to_string($message.message), \"flatten\", true);\n    set_fields(to_map(compliance_fields));\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "77893bcc-c137-4f15-9c53-3dacff2d6078",
      "data": {
        "title": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance - 4"
        },
        "description": {
          "@type": "string",
          "@value": "Cleanup message fields"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"graylog-professionals-windows-compliance - 4\"\nwhen\n    to_string($message.nxlog_tag) == \"Compliance_WindowsServerRoles\" \n    \nthen\n    set_field(\"vendor_windows_feature\", [to_string($message.Name)]);\n    set_field(\"vendor_windows_feature_installed\", to_string($message.Installed));\n    set_field(\"vendor_windows_feature_displayname\", [to_string($message.DisplayName)]);\n    set_field(\"vendor_windows_feature_description\", to_string($message.Description));\n    \n    remove_multiple_fields(\n        pattern: \"[A-Z][A-Za-z0-9-_]*\",\n        message: $message\n        );\n        \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "310e495d-6b54-4368-aeab-39c2e3585172",
      "data": {
        "title": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance - 2"
        },
        "description": {
          "@type": "string",
          "@value": "Save installed Windows Features to Lookup Table"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"graylog-professionals-windows-compliance - 2\"\nwhen\n    to_string($message.nxlog_tag) == \"Compliance_WindowsServerRoles\" &&\n    to_string($message.Installed) == \"true\"\n    \nthen\n    lookup_add_string_list(\n        lookup_table: \"graylog-professionals-windows-compliance-by-hostname\", \n        key: to_string($message.source), \n        value: [ to_string($message.Name)],\n        keep_duplicates: false\n        );\n         \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "242c0b28-e95d-409a-8ec1-aba7e6b56227",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance-by-hostname"
        },
        "title": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance-by-hostname"
        },
        "description": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance-by-hostname"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "guava_cache"
          },
          "max_size": {
            "@type": "integer",
            "@value": 1000
          },
          "expire_after_access": {
            "@type": "long",
            "@value": 0
          },
          "expire_after_access_unit": {
            "@type": "string",
            "@value": "SECONDS"
          },
          "expire_after_write": {
            "@type": "long",
            "@value": 1
          },
          "expire_after_write_unit": {
            "@type": "string",
            "@value": "HOURS"
          },
          "ignore_null": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "5ca6d97e-66bf-4d33-835a-c63e9f6076cc",
      "data": {
        "title": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance - 5"
        },
        "description": {
          "@type": "string",
          "@value": "Delete useless Messages (OPTIONAL, currently commented out to avoid it to become effective)"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"graylog-professionals-windows-compliance - 5\"\nwhen\n    to_string($message.nxlog_tag) == \"Compliance_WindowsServerRoles\" &&\n    to_string($message.Installed) == \"false\"\n    \nthen\n    //drop_message();\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "c4d5c32e-ad1c-4841-8834-dc286e57b743",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "242c0b28-e95d-409a-8ec1-aba7e6b56227"
        },
        "name": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance-by-hostname"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "59ef40b7-0c0c-4258-bd28-5b7da148a123"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance-by-hostname"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance-by-hostname"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "ba68a905-f6e5-4048-b121-412575825011",
      "data": {
        "title": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance - 3b"
        },
        "description": {
          "@type": "string",
          "@value": "Replace Message Field"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"graylog-professionals-windows-compliance - 3b\"\nwhen\n    to_string($message.nxlog_tag) == \"Compliance_WindowsServerRoles\" &&\n    to_string($message.Installed) == \"false\"\n    \nthen\n    set_field(\n        field: \"message\", \n        value: \"Windows Feature \" + to_string($message.DisplayName) + \" (\" + to_string($message.Name) + \") is currently not installed on \" + to_string($message.event_source) + \" with ip address \" + to_string($message.source_ip)\n    );\n        \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "sidecar_collector",
        "version": "1"
      },
      "id": "63592b7f-2ec1-459c-ae62-cd1856bca252",
      "data": {
        "name": {
          "@type": "string",
          "@value": "nxlog_64"
        },
        "service_type": {
          "@type": "string",
          "@value": "svc"
        },
        "node_operating_system": {
          "@type": "string",
          "@value": "windows"
        },
        "executable_path": {
          "@type": "string",
          "@value": "C:\\Program Files\\Graylog\\sidecar\\nxlog\\nxlog.exe"
        },
        "execute_parameters": {
          "@type": "string",
          "@value": "-c \"%s\""
        },
        "validation_parameters": {
          "@type": "string",
          "@value": "-v -f -c \"%s\""
        },
        "default_template": {
          "@type": "string",
          "@value": "define ROOT C:\\Program Files\\Graylog\\sidecar\\nxlog\n\nModuledir %ROOT%\\modules\nCacheDir %ROOT%\\data\nPidfile %ROOT%\\data\\nxlog.pid\nSpoolDir %ROOT%\\data\nLogFile %ROOT%\\data\\nxlog.log\nLogLevel INFO\n\n\n<Extension logrotate>\n  Module  xm_fileop\n    <Schedule>\n      When    @daily\n      Exec    file_cycle('%ROOT%\\data\\nxlog.log', 7);\n     </Schedule>\n</Extension>\n\n\n<Extension gelfExt>\n  Module xm_gelf\n  ShortMessageLength 65536\n</Extension>\n\n\n<Extension json>\n  Module  xm_json\n</Extension>\n\n\n<Input wineventlog>\n    Module im_msvistalog\n    PollInterval 1\n    SavePos True\n    ReadFromLast True\n\n    <QueryXML>\n        <QueryList>\n          <Query Id=\"0\">\n             <Select Path=\"Security\">*</Select>\n             <Select Path=\"Microsoft-Windows-PowerShell/Operational\">*</Select>\n          </Query>\n          <Query Id=\"1\">\n             \n          </Query>\n        </QueryList>\n    </QueryXML>\n</Input>\n\n\n<Input file>\n\tModule im_file\n\tFile \"C:\\Program Files\\Graylog\\sidecar\\logs\\*.log\"\n\tPollInterval 1\n\tSavePos\tTrue\n\tReadFromLast True\n\tRecursive False\n\tRenameCheck False\n\tExec $FileName = file_name();\n</Input>\n\n\n<Output gelf>\n\tModule om_tcp\n\tHost graylog.demo.io\n\tPort 12201\n\tOutputType  GELF_TCP\n\t<Exec>\n\t  # These fields are needed for Graylog\n\t  $gl2_source_collector = '${sidecar.nodeId}';\n\t  $collector_node_id = '${sidecar.nodeName}';\n\t  $agent_type = 'nxlog';\n\t</Exec>\n</Output>\n\n\n<Route route-1>\n  Path wineventlog => gelf\n</Route>\n<Route route-2>\n  Path file => gelf\n</Route>"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "sidecar_collector_configuration",
        "version": "1"
      },
      "id": "b9b1f390-326c-44de-99a1-982594703b7d",
      "data": {
        "collector_id": {
          "@type": "string",
          "@value": "63592b7f-2ec1-459c-ae62-cd1856bca252"
        },
        "title": {
          "@type": "string",
          "@value": "nxlog-ce_64_windows_gelf_v2"
        },
        "color": {
          "@type": "string",
          "@value": "#f44336"
        },
        "template": {
          "@type": "string",
          "@value": "define ROOT C:\\Program Files\\Graylog\\sidecar\\nxlog\ndefine SYSTEMROOT C:\\Windows\n\nModuledir %ROOT%\\modules\nCacheDir %ROOT%\\data\nPidfile %ROOT%\\data\\nxlog.pid\nSpoolDir %ROOT%\\data\nLogFile %ROOT%\\data\\nxlog.log\nLogLevel INFO\n\n\n<Extension logrotate>\n  Module  xm_fileop\n    <Schedule>\n      When    @daily\n      Exec    file_cycle('%ROOT%\\data\\nxlog.log', 7);\n     </Schedule>\n</Extension>\n\n\n<Extension gelfExt>\n  Module xm_gelf\n  ShortMessageLength 65536\n</Extension>\n\n\n<Extension _json>\n    Module  xm_json\n</Extension>\n\n\n<Input wineventlog>\n    # Send Windows Security Logs\n    Module im_msvistalog\n    PollInterval 5\n    SavePos True\n    ReadFromLast True\n\n    <QueryXML>\n        <QueryList>\n          <Query Id=\"0\">\n             <Select Path=\"Security\">*</Select>\n             <Select Path=\"System\">*</Select>\n             <Select Path=\"Application\">*</Select>\n             <Select Path=\"Microsoft-Windows-AppLocker/EXE and DLL\">*</Select>\n             <Select Path=\"Microsoft-Windows-AppLocker/MSI and Script\">*</Select>\n             <Select Path=\"Microsoft-Windows-AppLocker/Packaged app-Deployment\">*</Select>\n             <Select Path=\"Microsoft-Windows-AppLocker/Packaged app-Execution\">*</Select>\n             <Select Path=\"Microsoft-Windows-GroupPolicy/Operational\">*</Select>\n             <Select Path=\"Microsoft-Windows-PowerShell/Operational\">*</Select>\n             <Select Path=\"Microsoft-Windows-Security-Audit-Configuration-Client/Operational\">*</Select>\n             <Select Path=\"Microsoft-Windows-SMBServer/Operational\">*</Select>\n             <Select Path=\"Microsoft-Windows-SMBServer/Security\">*</Select>\n             <Select Path=\"Microsoft-Windows-Windows Defender/Operational\">*</Select>\n          </Query>\n        </QueryList>\n    </QueryXML>\n</Input>\n\n\n<Input internal>\n    # Sending NXLog Logs\n    Module  im_internal\n</Input>\n\n\n<Input mark>\n    # Send Heartbeat every 1 Minute\n    Module          im_mark\n    MarkInterval    1\n    Mark            -=| ALIVE |=-\n</Input>\n\n\n<Input file>\n    # Send Graylog Sidecar logs\n\tModule im_file\n\tFile \"C:\\Program Files\\Graylog\\sidecar\\logs\\*.log\"\n\tPollInterval 1\n\tSavePos\tTrue\n\tReadFromLast True\n\tRecursive False\n\tRenameCheck False\n\tExec $FileName = file_name();\n</Input>\n\n\n<Input powershell>\n    # https://docs.nxlog.co/integrate/powershell-scripts.html\n    # Send overview of installed roles every 10 minutes\n    Module im_exec\n    Restart True\n    \n    Command \"%SYSTEMROOT%\\system32\\WindowsPowerShell\\v1.0\\powershell.exe\"\n    \n    ## Using the configuration from the following line will only send the installed Features to Graylog\n    #Arg     Get-WindowsFeature | Where-Object { $_.Installed -eq $true } | Foreach-Object { ConvertTo-Json -InputObject $_ -Compress }; Start-Sleep -Seconds 600\n    \n    ## Using the configuration from the following line will send an overview of all installed and available Features to Graylog\n    Arg     Get-WindowsFeature | Foreach-Object { ConvertTo-Json -InputObject $_ -Compress }; Start-Sleep -Seconds 600\n    \n    <Exec>\n        $nxlog_tag = 'Compliance_WindowsServerRoles'; \n        $source_ip = host_ip(); \n        $event_source = hostname_fqdn();\n    </Exec>\n    \n</Input>\n\n\n<Output gelf>\n\tModule om_tcp\n\tHost ${user.graylog_host}\n\tPort 12148\n\tOutputType GELF_TCP\n\t<Exec>\n\t  # These fields are needed for Graylog\n\t  $gl2_source_collector = '${sidecar.nodeId}';\n\t  $collector_node_id = '${sidecar.nodeName}';\n\t  $agent_type = 'nxlog';\n\t</Exec>\n</Output>\n\n\n<Route route-1>\n  Path wineventlog => gelf\n</Route>\n<Route route-2>\n  Path file => gelf\n</Route>\n<Route route-3>\n  Path internal => gelf\n</Route>\n<Route route-4>\n  Path mark => gelf\n</Route>\n<Route route-5>\n  Path powershell => gelf\n</Route>"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "dashboard",
        "version": "2"
      },
      "id": "05529f6f-eada-4b9b-8d09-0630a130fd7d",
      "data": {
        "summary": {
          "@type": "string",
          "@value": "Graylog Professionals - Windows Compliance Dashboard"
        },
        "search": {
          "queries": [
            {
              "id": "a7aeb684-b96b-4984-92e5-1bd0e8b03acd",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "nxlog_tag:Compliance_WindowsServerRoles AND vendor_windows_feature_installed:true"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 3600,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "card",
                      "id": "installiert auf x Serversystemen",
                      "field": "event_source"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "vendor_windows_feature"
                      ],
                      "limit": 50,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "5f30e005-cd88-4a17-9821-f7aca387b41e",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "pivot",
                      "field": "vendor_windows_feature",
                      "direction": "Ascending"
                    }
                  ]
                }
              ]
            }
          ],
          "parameters": [],
          "requires": {},
          "owner": "admin",
          "created_at": "2025-09-26T05:44:24.546Z"
        },
        "created_at": "2025-09-26T05:41:08.329Z",
        "requires": {},
        "state": {
          "a7aeb684-b96b-4984-92e5-1bd0e8b03acd": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "widget": {
                "9a93b4e7-8931-466b-8d21-f2140dcb762e": "Ãœbersicht installierte Windows Server Rollen",
                "4d74c841-14af-44f0-a12e-32186d7661c9": "Messages for vendor_windows_feature:RSAT"
              },
              "tab": {
                "title": "Windows Server Roles"
              }
            },
            "widgets": [
              {
                "config": {
                  "visualization": "table",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 50,
                  "row_pivots": [
                    {
                      "fields": [
                        "vendor_windows_feature"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 50,
                        "skip_empty_values": false
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "installiert auf x Serversystemen"
                      },
                      "function": "card(event_source)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": [
                      "vendor_windows_feature"
                    ]
                  },
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "pivot",
                      "field": "vendor_windows_feature",
                      "direction": "Ascending"
                    }
                  ]
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "nxlog_tag:Compliance_WindowsServerRoles AND vendor_windows_feature_installed:true"
                },
                "timerange": {
                  "from": 3600,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "9a93b4e7-8931-466b-8d21-f2140dcb762e",
                "filters": []
              }
            ],
            "widget_mapping": {
              "9a93b4e7-8931-466b-8d21-f2140dcb762e": [
                "5f30e005-cd88-4a17-9821-f7aca387b41e"
              ]
            },
            "positions": {
              "9a93b4e7-8931-466b-8d21-f2140dcb762e": {
                "col": 1,
                "row": 1,
                "height": 6,
                "width": "Infinity"
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "admin",
        "title": {
          "@type": "string",
          "@value": "Graylog Professionals - Windows Compliance Dashboard"
        },
        "type": "DASHBOARD",
        "description": {
          "@type": "string",
          "@value": "Graylog Professionals - Windows Compliance Dashboard"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "2ed1fd07-36e0-4c84-b917-5bfc8fbe9a3f",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Windows Professionals: Compliance Enrichment"
        },
        "description": {
          "@type": "string",
          "@value": "Windows Professionals: Compliance Enrichment"
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Windows Professionals: Compliance Enrichment\"\nstage 0 match either\nstage 1 match either\nrule \"graylog-compliance-enrichment-1\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "e3b99eb2-385f-47f5-b02c-c09b3774d8af"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "49ce1595-e0e3-447b-bfd6-00156873c6cf",
      "data": {
        "title": {
          "@type": "string",
          "@value": "graylog-compliance-enrichment-1"
        },
        "description": {
          "@type": "string",
          "@value": "Windows Professionals: Compliance Enrichment"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"graylog-compliance-enrichment-1\"\nwhen\n    true\n\nthen\n    let server_roles = lookup_string_list(\n        lookup_table: \"graylog-professionals-windows-compliance-by-hostname\",\n        key: to_string($message.event_reporter)\n    );\n    \n    set_field(\"vendor_windows_feature\", server_roles);\n    \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "59ef40b7-0c0c-4258-bd28-5b7da148a123",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance-by-hostname"
        },
        "title": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance-by-hostname"
        },
        "description": {
          "@type": "string",
          "@value": "Windows Server Roles"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "mongodb"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "1b230e99-0c5c-4219-b69b-9c554cad0a98",
      "data": {
        "title": {
          "@type": "string",
          "@value": "graylog-professionals-windows-compliance - 3a"
        },
        "description": {
          "@type": "string",
          "@value": "Replace Message Field"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"graylog-professionals-windows-compliance - 3a\"\nwhen\n    to_string($message.nxlog_tag) == \"Compliance_WindowsServerRoles\" &&\n    to_string($message.Installed) == \"true\"\n    \nthen\n    set_field(\n        field: \"message\", \n        value: \"Windows Feature \" + to_string($message.DisplayName) + \" (\" + to_string($message.Name) + \") is currently installed on \" + to_string($message.event_source) + \" with ip address \" + to_string($message.source_ip)\n    );\n        \nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream_title",
        "version": "1"
      },
      "id": "183d9976-07f4-4872-b253-08608d7f4a3a",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Default Stream"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream_title",
        "version": "1"
      },
      "id": "e3b99eb2-385f-47f5-b02c-c09b3774d8af",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Illuminate:Windows Security Event Log Messages"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.3+700dd8f"
        }
      ]
    }
  ]
}